{"version":3,"sources":["webpack:///x-bubbles.min.js","webpack:///webpack/bootstrap 2a125afad805ec42ecdd","webpack:///./index.js","webpack:///../~/raf/index.js","webpack:///../~/performance-now/lib/performance-now.js","webpack:///../~/process/browser.js","webpack:///./core/events.js","webpack:///./core/events/dblclick.js","webpack:///./context.js","webpack:///./core/text.js","webpack:///./core/bubble.js","webpack:///./core/bubbleset.js","webpack:///./core/events/click.js","webpack:///./core/select.js","webpack:///./core/cursor.js","webpack:///./core/events/focus.js","webpack:///./core/events/blur.js","webpack:///./core/event.js","webpack:///./polyfills/CustomEventCommon.js","webpack:///./core/drag.js","webpack:///./core/constant.js","webpack:///./core/editor.js"],"names":["XBubbles","modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","optionsPrepare","options","typeBubbleFormation","bubbleFormation","typeBubbleDeformation","bubbleDeformation","Function","fireChange","dispatch","this","EV","CHANGE","bubbles","cancelable","fireInput","textRange","text","currentTextRange","editText","textClean","toString","_bubbleValue","BUBBLE_INPUT","detail","data","throttleRaf","callback","context","throttle","animationCallback","raf","apply","arguments","_typeof","Symbol","iterator","obj","constructor","prototype","_extends","Object","assign","target","i","length","source","key","hasOwnProperty","events","_require","drag","editor","bubble","bubbleset","cursor","_require2","create","HTMLElement","createdCallback","value","setAttribute","attachedCallback","addEventListener","focus","blur","click","dblclick","init","bubbling","detachedCallback","removeEventListener","destroy","name","_options","classBubble","draggable","separator","ending","begining","dataset","items","get","getBubbles","innerText","set","firstChild","removeChild","html2text","appendChild","document","createTextNode","innerHTML","addBubble","bubbleText","nodeBubble","text2bubble","restore","registerElement","extends","global","now","root","window","vendors","suffix","caf","last","queue","frameDuration","_now","next","Math","max","setTimeout","cp","slice","cancelled","e","round","push","handle","fn","cancel","polyfill","requestAnimationFrame","cancelAnimationFrame","process","getNanoSeconds","hrtime","loadTime","performance","hr","Date","getTime","defaultSetTimout","Error","defaultClearTimeout","runTimeout","fun","cachedSetTimeout","runClearTimeout","marker","cachedClearTimeout","clearTimeout","cleanUpNextTick","draining","currentQueue","concat","queueIndex","drainQueue","timeout","len","run","Item","array","noop","nextTick","args","Array","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","binding","cwd","chdir","dir","umask","event","nodeSet","closestNodeSet","closestNodeBubble","selection","getSelection","preventDefault","rangeParams","dataText","startOffset","endOffset","textFake","createZws","textNode","replaceChild","insertBefore","range","createRange","setStart","setEnd","removeAllRanges","addRange","eval","replace","pointNode","focusNode","nodeType","Node","TEXT_NODE","anchorNode","undefined","startNode","endNode","item","previousSibling","nextSibling","setStartBefore","setEndAfter","remove","node","rangeCount","anchor","createElement","getRangeAt","surroundContents","parentNode","collapse","replaceString","nodeValue","arrowLeft","extend","isCollapsed","offset","anchorOffset","min","focusOffset","position","compareDocumentPosition","DOCUMENT_POSITION_FOLLOWING","substring","checkZws","arrowRight","DOCUMENT_POSITION_PRECEDING","DOMContainer","implementation","createHTMLDocument","body","trim","selectAll","fromNode","toNode","hasBubbles","TEXT_ZWS","REG_ZWS","test","String","REG_REPLACE_NON_PRINTABLE","isBubbleNode","ELEMENT_NODE","hasAttribute","wrap","classList","add","ranges","getBubbleRanges","nodes","forEach","deleteContents","textParts","split","map","trimIterator","filter","nonEmptyIterator","reduce","parts","str","parseFragmentByEnding","parseFragmentByBeginning","fragment","createDocumentFragment","textPart","insertNode","rng","children","childNodes","setEndBefore","Boolean","reg","lastIndex","loop","exec","res","index","getAttribute","prevBubble","nextBubble","lastBubble","querySelector","headBubble","querySelectorAll","findBubbleLeft","select","clear","metaKey","shiftKey","startRangeSelect","uniq","toggleUniq","list","headList","lastList","setSelected","all","PATH_NOT_SELECTED","PATH_SELECTED","has","head","removeAttribute","isSelected","removeSelected","basis","restoreBasis","fakeText","hasChildNodes","lastNode","isEqualNode","currentTarget","element","params","dispatchEvent","Custom","forwardingEvents","fromElement","toElement","capture","CustomEventCommon","CustomEvent","doc","protoEvent","Event","issetCustomEvent","createEvent","stopImmediatePropagation","immediatePropagationStopped","stopPropagation","eventName","evt","initCustomEvent","initEvent","onDragstart","currentDragSet","CLS","DRAGSTART","dataTransfer","effectAllowed","setData","onDrop","onDragover","dropEffect","onDragenter","DROPZONE","onDragleave","onDragend","KEY","a","Backspace","Bottom","Comma","Enter","Left","Right","Semicolon","Tab","Top","keyup","keypress","code","charCode","keyCode","keydown","enable","backSpace","begin","normalize","paste","clipboardData","contentType","getData","kind","type","some","getAsString"],"mappings":"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","file":"x-bubbles.min.js","sourcesContent":["var XBubbles =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\t\n\tvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\t\n\tvar raf = __webpack_require__(1);\n\tvar events = __webpack_require__(4);\n\t\n\tvar _require = __webpack_require__(15);\n\t\n\tvar dispatch = _require.dispatch;\n\t\n\tvar drag = __webpack_require__(17);\n\tvar editor = __webpack_require__(19);\n\tvar bubble = __webpack_require__(8);\n\tvar bubbleset = __webpack_require__(9);\n\tvar text = __webpack_require__(7);\n\tvar cursor = __webpack_require__(12);\n\t\n\tvar _require2 = __webpack_require__(18);\n\t\n\tvar EV = _require2.EV;\n\t\n\t\n\tvar XBubbles = Object.create(HTMLElement.prototype, {\n\t    createdCallback: {\n\t        value: function value() {\n\t            this.setAttribute('contenteditable', 'true');\n\t            this.setAttribute('spellcheck', 'false');\n\t\n\t            this.fireInput = throttleRaf(fireInput, this);\n\t            this.fireChange = throttleRaf(fireChange, this);\n\t        }\n\t    },\n\t\n\t    attachedCallback: {\n\t        value: function value() {\n\t            this.addEventListener('focus', events.focus);\n\t            this.addEventListener('blur', events.blur);\n\t            this.addEventListener('click', events.click);\n\t            this.addEventListener('dblclick', events.dblclick);\n\t\n\t            drag.init(this);\n\t            editor.init(this);\n\t            bubble.bubbling(this);\n\t        }\n\t    },\n\t\n\t    detachedCallback: {\n\t        value: function value() {\n\t            this.removeEventListener('focus', events.focus);\n\t            this.removeEventListener('blur', events.blur);\n\t            this.removeEventListener('click', events.click);\n\t            this.removeEventListener('dblclick', events.dblclick);\n\t\n\t            drag.destroy(this);\n\t            editor.destroy(this);\n\t        }\n\t    },\n\t\n\t    /*\n\t    attributeChangedCallback: {\n\t        value: function (name, prevValue, value) {}\n\t    },\n\t    */\n\t\n\t    options: {\n\t        value: function value(name, _value) {\n\t            if (!this._options) {\n\t                this._options = _extends({\n\t                    classBubble: 'bubble',\n\t                    draggable: true,\n\t                    separator: /[,;]/,\n\t                    ending: null, // /\\@ya\\.ru/g;\n\t                    begining: null,\n\t                    bubbleFormation: function bubbleFormation() {},\n\t                    bubbleDeformation: function bubbleDeformation() {}\n\t                }, this.dataset);\n\t\n\t                optionsPrepare(this._options);\n\t            }\n\t\n\t            if (typeof _value !== 'undefined') {\n\t                this._options[name] = _value;\n\t                optionsPrepare(this._options);\n\t            } else {\n\t                return this._options[name];\n\t            }\n\t        }\n\t    },\n\t\n\t    items: {\n\t        get: function get() {\n\t            return bubbleset.getBubbles(this);\n\t        }\n\t    },\n\t\n\t    innerText: {\n\t        get: function get() {\n\t            return '';\n\t        },\n\t\n\t        set: function set(value) {\n\t            while (this.firstChild) {\n\t                this.removeChild(this.firstChild);\n\t            }\n\t\n\t            value = text.html2text(value);\n\t            this.appendChild(document.createTextNode(value));\n\t            bubble.bubbling(this);\n\t        }\n\t    },\n\t\n\t    innerHTML: {\n\t        get: function get() {\n\t            return '';\n\t        },\n\t\n\t        set: function set(value) {\n\t            while (this.firstChild) {\n\t                this.removeChild(this.firstChild);\n\t            }\n\t\n\t            value = text.html2text(value);\n\t            this.appendChild(document.createTextNode(value));\n\t            bubble.bubbling(this);\n\t        }\n\t    },\n\t\n\t    addBubble: {\n\t        value: function value(bubbleText, data) {\n\t            var nodeBubble = bubble.create(this, bubbleText, data);\n\t\n\t            if (!nodeBubble) {\n\t                return;\n\t            }\n\t\n\t            text.text2bubble(this, nodeBubble);\n\t            cursor.restore(this);\n\t        }\n\t    }\n\t});\n\t\n\tmodule.exports = document.registerElement('x-bubbles', {\n\t    extends: 'div',\n\t    prototype: XBubbles\n\t});\n\t\n\tmodule.exports = XBubbles;\n\t\n\tfunction optionsPrepare(options) {\n\t    var typeBubbleFormation = _typeof(options.bubbleFormation);\n\t    var typeBubbleDeformation = _typeof(options.bubbleDeformation);\n\t\n\t    switch (typeBubbleFormation) {\n\t        case 'string':\n\t            options.bubbleFormation = new Function('wrap', '(function(wrap) { ' + options.bubbleFormation + '(wrap); }(wrap));');\n\t            break;\n\t        case 'function':\n\t            break;\n\t        default:\n\t            options.bubbleFormation = function () {};\n\t    }\n\t\n\t    switch (typeBubbleDeformation) {\n\t        case 'string':\n\t            options.bubbleDeformation = new Function('wrap', 'return (function(wrap) { return ' + options.bubbleDeformation + '(wrap); }(wrap));');\n\t            break;\n\t        case 'function':\n\t            break;\n\t        default:\n\t            options.bubbleDeformation = function () {};\n\t    }\n\t}\n\t\n\tfunction fireChange() {\n\t    dispatch(this, EV.CHANGE, {\n\t        bubbles: false,\n\t        cancelable: false\n\t    });\n\t}\n\t\n\tfunction fireInput() {\n\t    var textRange = text.currentTextRange();\n\t    if (textRange) {\n\t        var editText = text.textClean(textRange.toString());\n\t\n\t        if (this._bubbleValue !== editText) {\n\t            this._bubbleValue = editText;\n\t\n\t            dispatch(this, EV.BUBBLE_INPUT, {\n\t                bubbles: false,\n\t                cancelable: false,\n\t                detail: { data: editText }\n\t            });\n\t        }\n\t    }\n\t}\n\t\n\tfunction throttleRaf(callback, context) {\n\t    var throttle = 0;\n\t    var animationCallback = function animationCallback() {\n\t        throttle = 0;\n\t    };\n\t\n\t    return function () {\n\t        if (throttle) {\n\t            return;\n\t        }\n\t\n\t        throttle = raf(animationCallback);\n\t\n\t        callback.apply(context || this, arguments);\n\t    };\n\t}\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(global) {var now = __webpack_require__(2)\n\t  , root = typeof window === 'undefined' ? global : window\n\t  , vendors = ['moz', 'webkit']\n\t  , suffix = 'AnimationFrame'\n\t  , raf = root['request' + suffix]\n\t  , caf = root['cancel' + suffix] || root['cancelRequest' + suffix]\n\t\n\tfor(var i = 0; !raf && i < vendors.length; i++) {\n\t  raf = root[vendors[i] + 'Request' + suffix]\n\t  caf = root[vendors[i] + 'Cancel' + suffix]\n\t      || root[vendors[i] + 'CancelRequest' + suffix]\n\t}\n\t\n\t// Some versions of FF have rAF but not cAF\n\tif(!raf || !caf) {\n\t  var last = 0\n\t    , id = 0\n\t    , queue = []\n\t    , frameDuration = 1000 / 60\n\t\n\t  raf = function(callback) {\n\t    if(queue.length === 0) {\n\t      var _now = now()\n\t        , next = Math.max(0, frameDuration - (_now - last))\n\t      last = next + _now\n\t      setTimeout(function() {\n\t        var cp = queue.slice(0)\n\t        // Clear queue here to prevent\n\t        // callbacks from appending listeners\n\t        // to the current frame's queue\n\t        queue.length = 0\n\t        for(var i = 0; i < cp.length; i++) {\n\t          if(!cp[i].cancelled) {\n\t            try{\n\t              cp[i].callback(last)\n\t            } catch(e) {\n\t              setTimeout(function() { throw e }, 0)\n\t            }\n\t          }\n\t        }\n\t      }, Math.round(next))\n\t    }\n\t    queue.push({\n\t      handle: ++id,\n\t      callback: callback,\n\t      cancelled: false\n\t    })\n\t    return id\n\t  }\n\t\n\t  caf = function(handle) {\n\t    for(var i = 0; i < queue.length; i++) {\n\t      if(queue[i].handle === handle) {\n\t        queue[i].cancelled = true\n\t      }\n\t    }\n\t  }\n\t}\n\t\n\tmodule.exports = function(fn) {\n\t  // Wrap in a new function to prevent\n\t  // `cancel` potentially being assigned\n\t  // to the native rAF function\n\t  return raf.call(root, fn)\n\t}\n\tmodule.exports.cancel = function() {\n\t  caf.apply(root, arguments)\n\t}\n\tmodule.exports.polyfill = function() {\n\t  root.requestAnimationFrame = raf\n\t  root.cancelAnimationFrame = caf\n\t}\n\t\n\t/* WEBPACK VAR INJECTION */}.call(exports, (function() { return this; }())))\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(process) {// Generated by CoffeeScript 1.7.1\n\t(function() {\n\t  var getNanoSeconds, hrtime, loadTime;\n\t\n\t  if ((typeof performance !== \"undefined\" && performance !== null) && performance.now) {\n\t    module.exports = function() {\n\t      return performance.now();\n\t    };\n\t  } else if ((typeof process !== \"undefined\" && process !== null) && process.hrtime) {\n\t    module.exports = function() {\n\t      return (getNanoSeconds() - loadTime) / 1e6;\n\t    };\n\t    hrtime = process.hrtime;\n\t    getNanoSeconds = function() {\n\t      var hr;\n\t      hr = hrtime();\n\t      return hr[0] * 1e9 + hr[1];\n\t    };\n\t    loadTime = getNanoSeconds();\n\t  } else if (Date.now) {\n\t    module.exports = function() {\n\t      return Date.now() - loadTime;\n\t    };\n\t    loadTime = Date.now();\n\t  } else {\n\t    module.exports = function() {\n\t      return new Date().getTime() - loadTime;\n\t    };\n\t    loadTime = new Date().getTime();\n\t  }\n\t\n\t}).call(this);\n\t\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(3)))\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\t// shim for using process in browser\n\tvar process = module.exports = {};\n\t\n\t// cached from whatever global is present so that test runners that stub it\n\t// don't break things.  But we need to wrap it in a try catch in case it is\n\t// wrapped in strict mode code which doesn't define any globals.  It's inside a\n\t// function because try/catches deoptimize in certain engines.\n\t\n\tvar cachedSetTimeout;\n\tvar cachedClearTimeout;\n\t\n\tfunction defaultSetTimout() {\n\t    throw new Error('setTimeout has not been defined');\n\t}\n\tfunction defaultClearTimeout () {\n\t    throw new Error('clearTimeout has not been defined');\n\t}\n\t(function () {\n\t    try {\n\t        if (typeof setTimeout === 'function') {\n\t            cachedSetTimeout = setTimeout;\n\t        } else {\n\t            cachedSetTimeout = defaultSetTimout;\n\t        }\n\t    } catch (e) {\n\t        cachedSetTimeout = defaultSetTimout;\n\t    }\n\t    try {\n\t        if (typeof clearTimeout === 'function') {\n\t            cachedClearTimeout = clearTimeout;\n\t        } else {\n\t            cachedClearTimeout = defaultClearTimeout;\n\t        }\n\t    } catch (e) {\n\t        cachedClearTimeout = defaultClearTimeout;\n\t    }\n\t} ())\n\tfunction runTimeout(fun) {\n\t    if (cachedSetTimeout === setTimeout) {\n\t        //normal enviroments in sane situations\n\t        return setTimeout(fun, 0);\n\t    }\n\t    // if setTimeout wasn't available but was latter defined\n\t    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n\t        cachedSetTimeout = setTimeout;\n\t        return setTimeout(fun, 0);\n\t    }\n\t    try {\n\t        // when when somebody has screwed with setTimeout but no I.E. maddness\n\t        return cachedSetTimeout(fun, 0);\n\t    } catch(e){\n\t        try {\n\t            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n\t            return cachedSetTimeout.call(null, fun, 0);\n\t        } catch(e){\n\t            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n\t            return cachedSetTimeout.call(this, fun, 0);\n\t        }\n\t    }\n\t\n\t\n\t}\n\tfunction runClearTimeout(marker) {\n\t    if (cachedClearTimeout === clearTimeout) {\n\t        //normal enviroments in sane situations\n\t        return clearTimeout(marker);\n\t    }\n\t    // if clearTimeout wasn't available but was latter defined\n\t    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n\t        cachedClearTimeout = clearTimeout;\n\t        return clearTimeout(marker);\n\t    }\n\t    try {\n\t        // when when somebody has screwed with setTimeout but no I.E. maddness\n\t        return cachedClearTimeout(marker);\n\t    } catch (e){\n\t        try {\n\t            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n\t            return cachedClearTimeout.call(null, marker);\n\t        } catch (e){\n\t            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n\t            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n\t            return cachedClearTimeout.call(this, marker);\n\t        }\n\t    }\n\t\n\t\n\t\n\t}\n\tvar queue = [];\n\tvar draining = false;\n\tvar currentQueue;\n\tvar queueIndex = -1;\n\t\n\tfunction cleanUpNextTick() {\n\t    if (!draining || !currentQueue) {\n\t        return;\n\t    }\n\t    draining = false;\n\t    if (currentQueue.length) {\n\t        queue = currentQueue.concat(queue);\n\t    } else {\n\t        queueIndex = -1;\n\t    }\n\t    if (queue.length) {\n\t        drainQueue();\n\t    }\n\t}\n\t\n\tfunction drainQueue() {\n\t    if (draining) {\n\t        return;\n\t    }\n\t    var timeout = runTimeout(cleanUpNextTick);\n\t    draining = true;\n\t\n\t    var len = queue.length;\n\t    while(len) {\n\t        currentQueue = queue;\n\t        queue = [];\n\t        while (++queueIndex < len) {\n\t            if (currentQueue) {\n\t                currentQueue[queueIndex].run();\n\t            }\n\t        }\n\t        queueIndex = -1;\n\t        len = queue.length;\n\t    }\n\t    currentQueue = null;\n\t    draining = false;\n\t    runClearTimeout(timeout);\n\t}\n\t\n\tprocess.nextTick = function (fun) {\n\t    var args = new Array(arguments.length - 1);\n\t    if (arguments.length > 1) {\n\t        for (var i = 1; i < arguments.length; i++) {\n\t            args[i - 1] = arguments[i];\n\t        }\n\t    }\n\t    queue.push(new Item(fun, args));\n\t    if (queue.length === 1 && !draining) {\n\t        runTimeout(drainQueue);\n\t    }\n\t};\n\t\n\t// v8 likes predictible objects\n\tfunction Item(fun, array) {\n\t    this.fun = fun;\n\t    this.array = array;\n\t}\n\tItem.prototype.run = function () {\n\t    this.fun.apply(null, this.array);\n\t};\n\tprocess.title = 'browser';\n\tprocess.browser = true;\n\tprocess.env = {};\n\tprocess.argv = [];\n\tprocess.version = ''; // empty string to avoid regexp issues\n\tprocess.versions = {};\n\t\n\tfunction noop() {}\n\t\n\tprocess.on = noop;\n\tprocess.addListener = noop;\n\tprocess.once = noop;\n\tprocess.off = noop;\n\tprocess.removeListener = noop;\n\tprocess.removeAllListeners = noop;\n\tprocess.emit = noop;\n\t\n\tprocess.binding = function (name) {\n\t    throw new Error('process.binding is not supported');\n\t};\n\t\n\tprocess.cwd = function () { return '/' };\n\tprocess.chdir = function (dir) {\n\t    throw new Error('process.chdir is not supported');\n\t};\n\tprocess.umask = function() { return 0; };\n\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\texports.dblclick = __webpack_require__(5);\n\texports.click = __webpack_require__(10);\n\texports.focus = __webpack_require__(13);\n\texports.blur = __webpack_require__(14);\n\n/***/ },\n/* 5 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar context = __webpack_require__(6);\n\tvar text = __webpack_require__(7);\n\tvar bubbleset = __webpack_require__(9);\n\t\n\tmodule.exports = function (event) {\n\t    var nodeSet = bubbleset.closestNodeSet(event.target);\n\t\n\t    if (!nodeSet) {\n\t        return;\n\t    }\n\t\n\t    var nodeBubble = bubbleset.closestNodeBubble(event.target);\n\t\n\t    if (!nodeBubble) {\n\t        return;\n\t    }\n\t\n\t    var selection = context.getSelection();\n\t\n\t    if (!selection) {\n\t        return;\n\t    }\n\t\n\t    event.preventDefault();\n\t\n\t    var bubbleDeformation = nodeSet.options('bubbleDeformation');\n\t    var rangeParams = bubbleDeformation(nodeBubble);\n\t\n\t    if (!rangeParams) {\n\t        var dataText = text.textClean(nodeBubble.innerText);\n\t\n\t        rangeParams = {\n\t            text: dataText,\n\t            startOffset: 0,\n\t            endOffset: text.length\n\t        };\n\t    }\n\t\n\t    var textFake = text.createZws();\n\t    var textNode = context.document.createTextNode(rangeParams.text);\n\t\n\t    nodeSet.replaceChild(textNode, nodeBubble);\n\t    nodeSet.insertBefore(textFake, textNode);\n\t\n\t    var range = context.document.createRange();\n\t    range.setStart(textNode, rangeParams.startOffset);\n\t    range.setEnd(textNode, rangeParams.endOffset);\n\t\n\t    selection.removeAllRanges();\n\t    selection.addRange(range);\n\t};\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tmodule.exports = function () {\n\t    /* eslint no-eval: 0 */\n\t    return this || (1, eval)('this');\n\t}();\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar context = __webpack_require__(6);\n\tvar bubble = __webpack_require__(8);\n\tvar bubbleset = __webpack_require__(9);\n\t\n\t/* eslint-disable max-len */\n\tvar REG_REPLACE_NON_PRINTABLE = /[\\0-\\x1F\\x7F-\\x9F\\xAD\\u0378\\u0379\\u037F-\\u0383\\u038B\\u038D\\u03A2\\u0528-\\u0530\\u0557\\u0558\\u0560\\u0588\\u058B-\\u058E\\u0590\\u05C8-\\u05CF\\u05EB-\\u05EF\\u05F5-\\u0605\\u061C\\u061D\\u06DD\\u070E\\u070F\\u074B\\u074C\\u07B2-\\u07BF\\u07FB-\\u07FF\\u082E\\u082F\\u083F\\u085C\\u085D\\u085F-\\u089F\\u08A1\\u08AD-\\u08E3\\u08FF\\u0978\\u0980\\u0984\\u098D\\u098E\\u0991\\u0992\\u09A9\\u09B1\\u09B3-\\u09B5\\u09BA\\u09BB\\u09C5\\u09C6\\u09C9\\u09CA\\u09CF-\\u09D6\\u09D8-\\u09DB\\u09DE\\u09E4\\u09E5\\u09FC-\\u0A00\\u0A04\\u0A0B-\\u0A0E\\u0A11\\u0A12\\u0A29\\u0A31\\u0A34\\u0A37\\u0A3A\\u0A3B\\u0A3D\\u0A43-\\u0A46\\u0A49\\u0A4A\\u0A4E-\\u0A50\\u0A52-\\u0A58\\u0A5D\\u0A5F-\\u0A65\\u0A76-\\u0A80\\u0A84\\u0A8E\\u0A92\\u0AA9\\u0AB1\\u0AB4\\u0ABA\\u0ABB\\u0AC6\\u0ACA\\u0ACE\\u0ACF\\u0AD1-\\u0ADF\\u0AE4\\u0AE5\\u0AF2-\\u0B00\\u0B04\\u0B0D\\u0B0E\\u0B11\\u0B12\\u0B29\\u0B31\\u0B34\\u0B3A\\u0B3B\\u0B45\\u0B46\\u0B49\\u0B4A\\u0B4E-\\u0B55\\u0B58-\\u0B5B\\u0B5E\\u0B64\\u0B65\\u0B78-\\u0B81\\u0B84\\u0B8B-\\u0B8D\\u0B91\\u0B96-\\u0B98\\u0B9B\\u0B9D\\u0BA0-\\u0BA2\\u0BA5-\\u0BA7\\u0BAB-\\u0BAD\\u0BBA-\\u0BBD\\u0BC3-\\u0BC5\\u0BC9\\u0BCE\\u0BCF\\u0BD1-\\u0BD6\\u0BD8-\\u0BE5\\u0BFB-\\u0C00\\u0C04\\u0C0D\\u0C11\\u0C29\\u0C34\\u0C3A-\\u0C3C\\u0C45\\u0C49\\u0C4E-\\u0C54\\u0C57\\u0C5A-\\u0C5F\\u0C64\\u0C65\\u0C70-\\u0C77\\u0C80\\u0C81\\u0C84\\u0C8D\\u0C91\\u0CA9\\u0CB4\\u0CBA\\u0CBB\\u0CC5\\u0CC9\\u0CCE-\\u0CD4\\u0CD7-\\u0CDD\\u0CDF\\u0CE4\\u0CE5\\u0CF0\\u0CF3-\\u0D01\\u0D04\\u0D0D\\u0D11\\u0D3B\\u0D3C\\u0D45\\u0D49\\u0D4F-\\u0D56\\u0D58-\\u0D5F\\u0D64\\u0D65\\u0D76-\\u0D78\\u0D80\\u0D81\\u0D84\\u0D97-\\u0D99\\u0DB2\\u0DBC\\u0DBE\\u0DBF\\u0DC7-\\u0DC9\\u0DCB-\\u0DCE\\u0DD5\\u0DD7\\u0DE0-\\u0DF1\\u0DF5-\\u0E00\\u0E3B-\\u0E3E\\u0E5C-\\u0E80\\u0E83\\u0E85\\u0E86\\u0E89\\u0E8B\\u0E8C\\u0E8E-\\u0E93\\u0E98\\u0EA0\\u0EA4\\u0EA6\\u0EA8\\u0EA9\\u0EAC\\u0EBA\\u0EBE\\u0EBF\\u0EC5\\u0EC7\\u0ECE\\u0ECF\\u0EDA\\u0EDB\\u0EE0-\\u0EFF\\u0F48\\u0F6D-\\u0F70\\u0F98\\u0FBD\\u0FCD\\u0FDB-\\u0FFF\\u10C6\\u10C8-\\u10CC\\u10CE\\u10CF\\u1249\\u124E\\u124F\\u1257\\u1259\\u125E\\u125F\\u1289\\u128E\\u128F\\u12B1\\u12B6\\u12B7\\u12BF\\u12C1\\u12C6\\u12C7\\u12D7\\u1311\\u1316\\u1317\\u135B\\u135C\\u137D-\\u137F\\u139A-\\u139F\\u13F5-\\u13FF\\u169D-\\u169F\\u16F1-\\u16FF\\u170D\\u1715-\\u171F\\u1737-\\u173F\\u1754-\\u175F\\u176D\\u1771\\u1774-\\u177F\\u17DE\\u17DF\\u17EA-\\u17EF\\u17FA-\\u17FF\\u180F\\u181A-\\u181F\\u1878-\\u187F\\u18AB-\\u18AF\\u18F6-\\u18FF\\u191D-\\u191F\\u192C-\\u192F\\u193C-\\u193F\\u1941-\\u1943\\u196E\\u196F\\u1975-\\u197F\\u19AC-\\u19AF\\u19CA-\\u19CF\\u19DB-\\u19DD\\u1A1C\\u1A1D\\u1A5F\\u1A7D\\u1A7E\\u1A8A-\\u1A8F\\u1A9A-\\u1A9F\\u1AAE-\\u1AFF\\u1B4C-\\u1B4F\\u1B7D-\\u1B7F\\u1BF4-\\u1BFB\\u1C38-\\u1C3A\\u1C4A-\\u1C4C\\u1C80-\\u1CBF\\u1CC8-\\u1CCF\\u1CF7-\\u1CFF\\u1DE7-\\u1DFB\\u1F16\\u1F17\\u1F1E\\u1F1F\\u1F46\\u1F47\\u1F4E\\u1F4F\\u1F58\\u1F5A\\u1F5C\\u1F5E\\u1F7E\\u1F7F\\u1FB5\\u1FC5\\u1FD4\\u1FD5\\u1FDC\\u1FF0\\u1FF1\\u1FF5\\u1FFF\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u206F\\u2072\\u2073\\u208F\\u209D-\\u209F\\u20BB-\\u20CF\\u20F1-\\u20FF\\u218A-\\u218F\\u23F4-\\u23FF\\u2427-\\u243F\\u244B-\\u245F\\u2700\\u2B4D-\\u2B4F\\u2B5A-\\u2BFF\\u2C2F\\u2C5F\\u2CF4-\\u2CF8\\u2D26\\u2D28-\\u2D2C\\u2D2E\\u2D2F\\u2D68-\\u2D6E\\u2D71-\\u2D7E\\u2D97-\\u2D9F\\u2DA7\\u2DAF\\u2DB7\\u2DBF\\u2DC7\\u2DCF\\u2DD7\\u2DDF\\u2E3C-\\u2E7F\\u2E9A\\u2EF4-\\u2EFF\\u2FD6-\\u2FEF\\u2FFC-\\u2FFF\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312E-\\u3130\\u318F\\u31BB-\\u31BF\\u31E4-\\u31EF\\u321F\\u32FF\\u4DB6-\\u4DBF\\u9FCD-\\u9FFF\\uA48D-\\uA48F\\uA4C7-\\uA4CF\\uA62C-\\uA63F\\uA698-\\uA69E\\uA6F8-\\uA6FF\\uA78F\\uA794-\\uA79F\\uA7AB-\\uA7F7\\uA82C-\\uA82F\\uA83A-\\uA83F\\uA878-\\uA87F\\uA8C5-\\uA8CD\\uA8DA-\\uA8DF\\uA8FC-\\uA8FF\\uA954-\\uA95E\\uA97D-\\uA97F\\uA9CE\\uA9DA-\\uA9DD\\uA9E0-\\uA9FF\\uAA37-\\uAA3F\\uAA4E\\uAA4F\\uAA5A\\uAA5B\\uAA7C-\\uAA7F\\uAAC3-\\uAADA\\uAAF7-\\uAB00\\uAB07\\uAB08\\uAB0F\\uAB10\\uAB17-\\uAB1F\\uAB27\\uAB2F-\\uABBF\\uABEE\\uABEF\\uABFA-\\uABFF\\uD7A4-\\uD7AF\\uD7C7-\\uD7CA\\uD7FC-\\uF8FF\\uFA6E\\uFA6F\\uFADA-\\uFAFF\\uFB07-\\uFB12\\uFB18-\\uFB1C\\uFB37\\uFB3D\\uFB3F\\uFB42\\uFB45\\uFBC2-\\uFBD2\\uFD40-\\uFD4F\\uFD90\\uFD91\\uFDC8-\\uFDEF\\uFDFE\\uFDFF\\uFE1A-\\uFE1F\\uFE27-\\uFE2F\\uFE53\\uFE67\\uFE6C-\\uFE6F\\uFE75\\uFEFD-\\uFF00\\uFFBF-\\uFFC1\\uFFC8\\uFFC9\\uFFD0\\uFFD1\\uFFD8\\uFFD9\\uFFDD-\\uFFDF\\uFFE7\\uFFEF-\\uFFFB\\uFFFE\\uFFFF]/g;\n\tvar REG_ZWS = /\\u200B/;\n\tvar TEXT_ZWS = '\\u200B';\n\t\n\texports.arrowRight = arrowRight;\n\texports.arrowLeft = arrowLeft;\n\texports.remove = remove;\n\texports.html2text = html2text;\n\texports.currentTextRange = currentTextRange;\n\texports.text2bubble = text2bubble;\n\texports.replaceString = replaceString;\n\texports.selectAll = selectAll;\n\texports.textClean = textClean;\n\texports.checkZws = checkZws;\n\texports.createZws = createZws;\n\t\n\tfunction text2bubble(nodeSet, nodeBubble, selection) {\n\t    selection = selection || context.getSelection();\n\t\n\t    if (!selection) {\n\t        return false;\n\t    }\n\t\n\t    var range = currentTextRange(selection);\n\t\n\t    if (!range) {\n\t        return false;\n\t    }\n\t\n\t    if (!nodeBubble) {\n\t        nodeBubble = bubble.create(nodeSet, range.toString());\n\t    }\n\t\n\t    if (!nodeBubble) {\n\t        return false;\n\t    }\n\t\n\t    selection.removeAllRanges();\n\t    selection.addRange(range);\n\t\n\t    replace(selection, nodeBubble);\n\t    return true;\n\t}\n\t\n\tfunction currentTextRange(selection) {\n\t    selection = selection || context.getSelection();\n\t\n\t    if (!selection) {\n\t        return;\n\t    }\n\t\n\t    var pointNode = selection.focusNode && selection.focusNode.nodeType === Node.TEXT_NODE ? selection.focusNode : selection.anchorNode && selection.anchorNode.nodeType === Node.TEXT_NODE ? selection.anchorNode : undefined;\n\t\n\t    if (!pointNode) {\n\t        return;\n\t    }\n\t\n\t    var range = context.document.createRange();\n\t    var startNode = pointNode;\n\t    var endNode = pointNode;\n\t    var item = pointNode;\n\t\n\t    while (item && item.nodeType === Node.TEXT_NODE) {\n\t        startNode = item;\n\t        item = item.previousSibling;\n\t    }\n\t\n\t    item = pointNode;\n\t\n\t    while (item && item.nodeType === Node.TEXT_NODE) {\n\t        endNode = item;\n\t        item = item.nextSibling;\n\t    }\n\t\n\t    range.setStartBefore(startNode);\n\t    range.setEndAfter(endNode);\n\t\n\t    return range;\n\t}\n\t\n\tfunction remove(selection) {\n\t    return replace(selection, createZws());\n\t}\n\t\n\tfunction replace(selection, node) {\n\t    selection = selection || context.getSelection();\n\t\n\t    if (!selection || !selection.rangeCount) {\n\t        return false;\n\t    }\n\t\n\t    var anchor = context.document.createElement('span');\n\t    selection.getRangeAt(0).surroundContents(anchor);\n\t    anchor.parentNode.replaceChild(node, anchor);\n\t\n\t    selection.removeAllRanges();\n\t    selection.collapse(node, 0);\n\t\n\t    return true;\n\t}\n\t\n\tfunction replaceString(data, selection) {\n\t    data = textClean(data);\n\t    if (!data) {\n\t        return false;\n\t    }\n\t\n\t    selection = selection || context.getSelection();\n\t    var textNode = context.document.createTextNode(data);\n\t\n\t    if (!replace(selection, textNode)) {\n\t        return false;\n\t    }\n\t\n\t    selection.collapse(textNode, textNode.nodeValue.length);\n\t    return true;\n\t}\n\t\n\tfunction arrowLeft(selection, extend) {\n\t    selection = selection || context.getSelection();\n\t\n\t    if (!selection) {\n\t        return false;\n\t    }\n\t\n\t    if (!selection.anchorNode || selection.anchorNode.nodeType !== Node.TEXT_NODE) {\n\t        return false;\n\t    }\n\t\n\t    if (!selection.isCollapsed && !extend) {\n\t        var node = selection.anchorNode;\n\t        var _offset = selection.anchorOffset;\n\t\n\t        if (selection.anchorNode === selection.focusNode) {\n\t            _offset = Math.min(selection.anchorOffset, selection.focusOffset);\n\t        } else {\n\t            var position = selection.anchorNode.compareDocumentPosition(selection.focusNode);\n\t            if (position & Node.DOCUMENT_POSITION_FOLLOWING) {\n\t                _offset = selection.focusOffset;\n\t                node = selection.focusNode;\n\t            }\n\t        }\n\t\n\t        selection.collapse(node, _offset);\n\t        return true;\n\t    }\n\t\n\t    var item = selection.focusNode;\n\t    var offset = selection.focusOffset;\n\t\n\t    while (item) {\n\t        if (item.nodeType !== Node.TEXT_NODE) {\n\t            return false;\n\t        }\n\t\n\t        if (offset === null) {\n\t            offset = item.nodeValue.length;\n\t        }\n\t\n\t        if (offset - 1 < 0) {\n\t            item = item.previousSibling;\n\t            offset = null;\n\t            continue;\n\t        }\n\t\n\t        var text = item.nodeValue.substring(offset - 1, offset);\n\t\n\t        if (checkZws(text)) {\n\t            offset = offset - 1;\n\t            continue;\n\t        }\n\t\n\t        break;\n\t    }\n\t\n\t    if (!item || offset === null) {\n\t        return false;\n\t    }\n\t\n\t    if (extend) {\n\t        selection.extend(item, offset - 1);\n\t    } else {\n\t        selection.collapse(item, offset - 1);\n\t    }\n\t\n\t    return true;\n\t}\n\t\n\tfunction arrowRight(selection, extend) {\n\t    selection = selection || context.getSelection();\n\t\n\t    if (!selection) {\n\t        return false;\n\t    }\n\t\n\t    if (!selection.focusNode || selection.focusNode.nodeType !== Node.TEXT_NODE) {\n\t        return false;\n\t    }\n\t\n\t    if (!selection.isCollapsed && !extend) {\n\t        var node = selection.focusNode;\n\t        var _offset2 = selection.focusOffset;\n\t\n\t        if (selection.focusNode === selection.anchorNode) {\n\t            _offset2 = Math.max(selection.focusOffset, selection.anchorOffset);\n\t        } else {\n\t            var position = selection.anchorNode.compareDocumentPosition(selection.focusNode);\n\t            if (position & Node.DOCUMENT_POSITION_PRECEDING) {\n\t                _offset2 = selection.anchorOffset;\n\t                node = selection.anchorNode;\n\t            }\n\t        }\n\t\n\t        selection.collapse(node, _offset2);\n\t        return true;\n\t    }\n\t\n\t    var item = selection.focusNode;\n\t    var offset = selection.focusOffset;\n\t\n\t    while (item) {\n\t        if (item.nodeType !== Node.TEXT_NODE) {\n\t            return false;\n\t        }\n\t\n\t        var len = item.nodeValue.length;\n\t\n\t        if (offset + 1 > len) {\n\t            item = item.nextSibling;\n\t            offset = 0;\n\t            continue;\n\t        }\n\t\n\t        var text = item.nodeValue.substring(offset, offset + 1);\n\t\n\t        if (checkZws(text)) {\n\t            offset = offset + 1;\n\t            continue;\n\t        }\n\t\n\t        break;\n\t    }\n\t\n\t    if (!item) {\n\t        return false;\n\t    }\n\t\n\t    if (extend) {\n\t        selection.extend(item, offset + 1);\n\t    } else {\n\t        selection.collapse(item, offset + 1);\n\t    }\n\t\n\t    return true;\n\t}\n\t\n\tfunction html2text(value) {\n\t    if (!value) {\n\t        return '';\n\t    }\n\t\n\t    var DOMContainer = document.implementation.createHTMLDocument('').body;\n\t    DOMContainer.innerText = value;\n\t\n\t    return DOMContainer.innerText.replace(/^[\\u0020\\u00a0]+$/gm, '').replace(/\\n/gm, ' ').trim();\n\t}\n\t\n\tfunction selectAll(selection, nodeSet) {\n\t    selection = selection || context.getSelection();\n\t    var node = selection && selection.anchorNode;\n\t\n\t    if (!node || node.nodeType !== Node.TEXT_NODE) {\n\t        return false;\n\t    }\n\t\n\t    var fromNode = void 0;\n\t    var toNode = void 0;\n\t    var item = node;\n\t\n\t    while (item && item.nodeType === Node.TEXT_NODE) {\n\t        fromNode = item;\n\t        item = item.previousSibling;\n\t    }\n\t\n\t    item = node;\n\t\n\t    while (item && item.nodeType === Node.TEXT_NODE) {\n\t        toNode = item;\n\t        item = item.nextSibling;\n\t    }\n\t\n\t    var hasBubbles = bubbleset.hasBubbles(nodeSet);\n\t    var range = document.createRange();\n\t    range.setStartBefore(fromNode);\n\t    range.setEndAfter(toNode);\n\t\n\t    var dataText = textClean(range.toString());\n\t\n\t    if (dataText || !dataText && !hasBubbles) {\n\t        if (!dataText) {\n\t            range.collapse();\n\t        }\n\t\n\t        selection.removeAllRanges();\n\t        selection.addRange(range);\n\t        return true;\n\t    }\n\t\n\t    return false;\n\t}\n\t\n\tfunction createZws() {\n\t    return document.createTextNode(TEXT_ZWS);\n\t}\n\t\n\tfunction checkZws(value) {\n\t    return REG_ZWS.test(value);\n\t}\n\t\n\tfunction textClean(value) {\n\t    return String(value || '').trim().replace(REG_REPLACE_NON_PRINTABLE, '');\n\t}\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar text = __webpack_require__(7);\n\t\n\texports.isBubbleNode = isBubbleNode;\n\texports.bubbling = bubbling;\n\texports.create = create;\n\t\n\tfunction isBubbleNode(node) {\n\t    if (!node || node.nodeType !== Node.ELEMENT_NODE) {\n\t        return false;\n\t    }\n\t\n\t    return node.hasAttribute('bubble');\n\t}\n\t\n\tfunction create(nodeSet, dataText) {\n\t    var data = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\t\n\t    dataText = text.textClean(dataText);\n\t\n\t    if (!dataText) {\n\t        return;\n\t    }\n\t\n\t    var bubbleFormation = nodeSet.options('bubbleFormation');\n\t    var classBubble = nodeSet.options('classBubble');\n\t    var draggable = nodeSet.options('draggable');\n\t    var wrap = document.createElement('span');\n\t\n\t    wrap.innerText = dataText;\n\t\n\t    if (draggable) {\n\t        wrap.setAttribute('draggable', 'true');\n\t    }\n\t\n\t    for (var key in data) {\n\t        wrap.setAttribute('data-' + key, String(data[key]));\n\t    }\n\t\n\t    bubbleFormation(wrap);\n\t\n\t    wrap.classList.add(classBubble);\n\t    wrap.setAttribute('bubble', '');\n\t    wrap.setAttribute('contenteditable', 'false');\n\t\n\t    return wrap;\n\t}\n\t\n\tfunction bubbling(nodeSet) {\n\t    var separator = nodeSet.options('separator');\n\t    var ending = nodeSet.options('ending');\n\t    var begining = nodeSet.options('begining');\n\t    var ranges = getBubbleRanges(nodeSet);\n\t    var nodes = [];\n\t\n\t    ranges.forEach(function (range) {\n\t        var dataText = text.textClean(range.toString());\n\t\n\t        if (!dataText) {\n\t            range.deleteContents();\n\t            return;\n\t        }\n\t\n\t        var textParts = [dataText];\n\t\n\t        if (separator) {\n\t            textParts = dataText.split(separator).map(trimIterator).filter(nonEmptyIterator);\n\t        }\n\t\n\t        if (ending) {\n\t            textParts = textParts.reduce(function (parts, str) {\n\t                return parts.concat(parseFragmentByEnding(str, ending));\n\t            }, []).map(trimIterator).filter(nonEmptyIterator);\n\t        } else if (begining) {\n\t            textParts = textParts.reduce(function (parts, str) {\n\t                return parts.concat(parseFragmentByBeginning(str, begining));\n\t            }, []).map(trimIterator).filter(nonEmptyIterator);\n\t        }\n\t\n\t        if (!textParts.length) {\n\t            range.deleteContents();\n\t        }\n\t\n\t        var fragment = document.createDocumentFragment();\n\t\n\t        textParts.forEach(function (textPart) {\n\t            var nodeBubble = create(nodeSet, textPart);\n\t            if (nodeBubble) {\n\t                fragment.appendChild(nodeBubble);\n\t                nodes.push(nodeBubble);\n\t            }\n\t        });\n\t\n\t        range.deleteContents();\n\t        range.insertNode(fragment);\n\t    });\n\t\n\t    nodeSet.fireChange();\n\t    return nodes;\n\t}\n\t\n\tfunction getBubbleRanges(set) {\n\t    var i = void 0;\n\t    var rng = void 0;\n\t    var node = void 0;\n\t    var ranges = [];\n\t    var children = set.childNodes;\n\t\n\t    for (i = 0; i < children.length; i++) {\n\t        node = children[i];\n\t\n\t        if (isBubbleNode(node)) {\n\t            if (rng) {\n\t                rng.setEndBefore(node);\n\t                ranges.push(rng);\n\t                rng = undefined;\n\t            }\n\t        } else {\n\t            if (!rng) {\n\t                rng = document.createRange();\n\t                rng.setStartBefore(node);\n\t            }\n\t        }\n\t    }\n\t\n\t    if (rng) {\n\t        rng.setEndAfter(node);\n\t        ranges.push(rng);\n\t    }\n\t\n\t    return ranges;\n\t}\n\t\n\tfunction trimIterator(str) {\n\t    return str.trim();\n\t}\n\t\n\tfunction nonEmptyIterator(str) {\n\t    return Boolean(str);\n\t}\n\t\n\tfunction parseFragmentByEnding(str, reg) {\n\t    var parts = [];\n\t    var lastIndex = 0;\n\t    var loop = 999;\n\t\n\t    reg.lastIndex = 0;\n\t    while (reg.exec(str) !== null && loop) {\n\t        loop--;\n\t        parts.push(str.substring(lastIndex, reg.lastIndex));\n\t        lastIndex = reg.lastIndex;\n\t    }\n\t\n\t    return parts;\n\t}\n\t\n\tfunction parseFragmentByBeginning(str, reg) {\n\t    var parts = [];\n\t    var res = void 0;\n\t    var index = 0;\n\t    var loop = 999;\n\t\n\t    reg.lastIndex = 0;\n\t    while ((res = reg.exec(str)) !== null && loop) {\n\t        loop--;\n\t        if (index !== res.index) {\n\t            parts.push(str.substring(index, res.index));\n\t            index = res.index;\n\t        }\n\t    }\n\t\n\t    parts.push(str.substring(index, str.length));\n\t    return parts;\n\t}\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar bubble = __webpack_require__(8);\n\tvar text = __webpack_require__(7);\n\tvar context = __webpack_require__(6);\n\t\n\tvar slice = Array.prototype.slice;\n\t\n\texports.lastBubble = function (nodeSet) {\n\t    return nodeSet.querySelector('[bubble]:last-child');\n\t};\n\t\n\texports.headBubble = function (nodeSet) {\n\t    return nodeSet.querySelector('[bubble]:first-child');\n\t};\n\t\n\texports.getBubbles = function (nodeSet) {\n\t    return slice.call(nodeSet.querySelectorAll('[bubble]'));\n\t};\n\t\n\texports.hasBubbles = function (nodeSet) {\n\t    return Boolean(nodeSet.querySelector('[bubble]'));\n\t};\n\t\n\texports.closestNodeSet = closestNodeSet;\n\texports.closestNodeBubble = closestNodeBubble;\n\texports.prevBubble = prevBubble;\n\texports.nextBubble = nextBubble;\n\t\n\texports.findBubbleLeft = function (selection) {\n\t    selection = selection || context.getSelection();\n\t\n\t    if (!selection || !selection.focusNode) {\n\t        return;\n\t    }\n\t\n\t    var node = selection.focusNode.previousSibling;\n\t\n\t    while (node) {\n\t        if (bubble.isBubbleNode(node)) {\n\t            return node;\n\t        }\n\t\n\t        if (node.nodeType === Node.TEXT_NODE && text.textClean(node.nodeValue)) {\n\t            return;\n\t        }\n\t\n\t        node = node.previousSibling;\n\t    }\n\t};\n\t\n\tfunction closestNodeSet(node) {\n\t    while (node) {\n\t        if (node.nodeType === Node.ELEMENT_NODE && node.getAttribute('is') === 'x-bubbles') {\n\t\n\t            return node;\n\t        }\n\t\n\t        node = node.parentNode;\n\t    }\n\t}\n\t\n\tfunction closestNodeBubble(node) {\n\t    while (node) {\n\t        if (bubble.isBubbleNode(node)) {\n\t            return node;\n\t        }\n\t\n\t        node = node.parentNode;\n\t    }\n\t}\n\t\n\tfunction prevBubble(target) {\n\t    var node = target && target.previousSibling;\n\t    while (node) {\n\t        if (bubble.isBubbleNode(node)) {\n\t            return node;\n\t        }\n\t\n\t        node = node.previousSibling;\n\t    }\n\t}\n\t\n\tfunction nextBubble(target) {\n\t    var node = target && target.nextSibling;\n\t    while (node) {\n\t        if (bubble.isBubbleNode(node)) {\n\t            return node;\n\t        }\n\t\n\t        node = node.nextSibling;\n\t    }\n\t}\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar context = __webpack_require__(6);\n\tvar bubbleset = __webpack_require__(9);\n\tvar select = __webpack_require__(11);\n\tvar cursor = __webpack_require__(12);\n\t\n\tmodule.exports = function (event) {\n\t    var nodeSet = bubbleset.closestNodeSet(event.target);\n\t\n\t    if (!nodeSet) {\n\t        return;\n\t    }\n\t\n\t    var nodeBubble = bubbleset.closestNodeBubble(event.target);\n\t\n\t    if (!nodeBubble) {\n\t        select.clear(nodeSet);\n\t\n\t        var selection = context.getSelection();\n\t\n\t        if (!selection || !selection.anchorNode || selection.anchorNode.nodeType !== Node.TEXT_NODE) {\n\t\n\t            cursor.restore(nodeSet);\n\t        }\n\t\n\t        return;\n\t    }\n\t\n\t    if (event.metaKey) {\n\t        select.add(nodeBubble);\n\t    } else if (event.shiftKey) {\n\t        if (!nodeSet.startRangeSelect) {\n\t            select.uniq(nodeBubble);\n\t        } else {\n\t            select.range(nodeBubble);\n\t        }\n\t    } else {\n\t        select.toggleUniq(nodeBubble);\n\t    }\n\t};\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar context = __webpack_require__(6);\n\tvar bubble = __webpack_require__(8);\n\tvar bubbleset = __webpack_require__(9);\n\t\n\tvar slice = Array.prototype.slice;\n\tvar PATH_SELECTED = '[bubble][selected]';\n\tvar PATH_NOT_SELECTED = '[bubble]:not([selected])';\n\t\n\texports.all = all;\n\texports.add = add;\n\texports.clear = clear;\n\texports.get = get;\n\texports.uniq = uniq;\n\texports.head = head;\n\texports.last = last;\n\texports.has = has;\n\texports.range = range;\n\texports.toggleUniq = toggleUniq;\n\t\n\tfunction range(node) {\n\t    if (!bubble.isBubbleNode(node)) {\n\t        return;\n\t    }\n\t\n\t    var set = node.parentNode;\n\t    var list = get(set);\n\t\n\t    if (!list.length) {\n\t        uniq(node);\n\t        return;\n\t    }\n\t\n\t    clear(set);\n\t\n\t    var headList = list[0];\n\t    var lastList = list[list.length - 1];\n\t\n\t    if (headList === lastList || !set.startRangeSelect) {\n\t        set.startRangeSelect = headList;\n\t    }\n\t\n\t    var fromNode = void 0;\n\t    var toNode = void 0;\n\t    var position = node.compareDocumentPosition(set.startRangeSelect);\n\t\n\t    if (position & Node.DOCUMENT_POSITION_PRECEDING) {\n\t        fromNode = set.startRangeSelect;\n\t        toNode = node;\n\t    } else {\n\t        fromNode = node;\n\t        toNode = set.startRangeSelect;\n\t    }\n\t\n\t    if (fromNode && toNode) {\n\t        var item = fromNode;\n\t\n\t        while (item) {\n\t            if (!setSelected(item)) {\n\t                break;\n\t            }\n\t\n\t            if (item === toNode) {\n\t                break;\n\t            }\n\t\n\t            item = item.nextSibling;\n\t        }\n\t\n\t        bubble.bubbling(set);\n\t    }\n\t}\n\t\n\tfunction all(nodeSet) {\n\t    slice.call(nodeSet.querySelectorAll(PATH_NOT_SELECTED)).forEach(function (item) {\n\t        return setSelected(item);\n\t    });\n\t    nodeSet.startRangeSelect = nodeSet.querySelector(PATH_SELECTED);\n\t\n\t    bubble.bubbling(nodeSet);\n\t\n\t    var selection = context.getSelection();\n\t    selection && selection.removeAllRanges();\n\t}\n\t\n\tfunction has(nodeSet) {\n\t    return Boolean(nodeSet.querySelector(PATH_SELECTED));\n\t}\n\t\n\tfunction head(set) {\n\t    return get(set)[0];\n\t}\n\t\n\tfunction last(set) {\n\t    var list = get(set);\n\t    return list[list.length - 1];\n\t}\n\t\n\tfunction get(nodeSet) {\n\t    return slice.call(nodeSet.querySelectorAll(PATH_SELECTED));\n\t}\n\t\n\tfunction clear(nodeSet) {\n\t    get(nodeSet).forEach(function (item) {\n\t        return item.removeAttribute('selected');\n\t    });\n\t}\n\t\n\tfunction add(node) {\n\t    if (setSelected(node)) {\n\t        var nodeSet = bubbleset.closestNodeSet(node);\n\t\n\t        nodeSet.startRangeSelect = node;\n\t        // ???\n\t        bubble.bubbling(nodeSet);\n\t\n\t        return true;\n\t    }\n\t\n\t    return false;\n\t}\n\t\n\tfunction uniq(node) {\n\t    if (!bubble.isBubbleNode(node)) {\n\t        return false;\n\t    }\n\t\n\t    var nodeSet = bubbleset.closestNodeSet(node);\n\t    var selection = context.getSelection();\n\t\n\t    selection && selection.removeAllRanges();\n\t    clear(nodeSet);\n\t\n\t    return add(node);\n\t}\n\t\n\tfunction toggleUniq(node) {\n\t    if (isSelected(node)) {\n\t        var nodeSet = bubbleset.closestNodeSet(node);\n\t\n\t        if (get(nodeSet).length === 1) {\n\t            return removeSelected(node);\n\t        }\n\t    }\n\t\n\t    return uniq(node);\n\t}\n\t\n\tfunction isSelected(node) {\n\t    return bubble.isBubbleNode(node) && node.hasAttribute('selected') || false;\n\t}\n\t\n\tfunction setSelected(node) {\n\t    if (bubble.isBubbleNode(node)) {\n\t        node.setAttribute('selected', '');\n\t        return true;\n\t    }\n\t\n\t    return false;\n\t}\n\t\n\tfunction removeSelected(node) {\n\t    if (bubble.isBubbleNode(node)) {\n\t        node.removeAttribute('selected');\n\t        return true;\n\t    }\n\t\n\t    return false;\n\t}\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar context = __webpack_require__(6);\n\tvar text = __webpack_require__(7);\n\tvar select = __webpack_require__(11);\n\t\n\texports.restore = restore;\n\texports.restoreBasis = restoreBasis;\n\t\n\tfunction restore(nodeSet) {\n\t    select.clear(nodeSet);\n\t    var basis = restoreBasis(nodeSet);\n\t    var selection = context.getSelection();\n\t    selection.removeAllRanges();\n\t    selection.collapse(basis, 1);\n\t}\n\t\n\tfunction restoreBasis(nodeSet) {\n\t    var fakeText = text.createZws();\n\t\n\t    if (nodeSet.hasChildNodes()) {\n\t        var lastNode = nodeSet.childNodes[nodeSet.childNodes.length - 1];\n\t\n\t        if (lastNode.isEqualNode(fakeText)) {\n\t            fakeText = lastNode;\n\t        } else {\n\t            nodeSet.appendChild(fakeText);\n\t        }\n\t    } else {\n\t        nodeSet.appendChild(fakeText);\n\t    }\n\t\n\t    return fakeText;\n\t}\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar cursor = __webpack_require__(12);\n\t\n\tmodule.exports = function (event) {\n\t    cursor.restore(event.currentTarget);\n\t};\n\n/***/ },\n/* 14 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar bubble = __webpack_require__(8);\n\tvar select = __webpack_require__(11);\n\t\n\tmodule.exports = function (event) {\n\t    select.clear(event.currentTarget);\n\t    bubble.bubbling(event.currentTarget);\n\t};\n\n/***/ },\n/* 15 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t/**\n\t * @module x-bubbles/event\n\t */\n\t\n\tvar context = __webpack_require__(6);\n\tvar CustomEventCommon = __webpack_require__(16);\n\t\n\t/**\n\t * Designer events.\n\t *\n\t * @example\n\t * const { Custom } = require('event');\n\t *\n\t * new Custom('custom-event', {\n\t *     bubbles: true,\n\t *     cancelable: true,\n\t *     detail: { data: '123' }\n\t * })\n\t *\n\t * @alias module:x-bubbles/event~Custom\n\t * @constructor\n\t */\n\tvar Custom = function () {\n\t    if (typeof context.CustomEvent === 'function') {\n\t        return context.CustomEvent;\n\t    }\n\t\n\t    return CustomEventCommon;\n\t}();\n\t\n\t/**\n\t * Dispatch event.\n\t *\n\t * @example\n\t * const { dispatch } = require('event');\n\t * dispatch(node, 'custom-event', {\n\t *     bubbles: true,\n\t *     cancelable: true,\n\t *     detail: { data: '123' }\n\t * })\n\t *\n\t * @alias module:x-bubbles/event.dispatch\n\t * @param {HTMLElement} element node events\n\t * @param {string} name event name\n\t * @param {Object} params the event parameters\n\t * @param {boolean} [params.bubbles=false]\n\t * @param {boolean} [params.cancelable=false]\n\t * @param {*} [params.detail]\n\t */\n\tfunction dispatch(element, name, params) {\n\t    element.dispatchEvent(new Custom(name, params || {}));\n\t}\n\t\n\t/**\n\t * Forwarding events\n\t *\n\t * @example\n\t * const { forwardingEvents } = require('event');\n\t * forwardingEvents('custom-event', fromNode, toNode, false);\n\t *\n\t * @param {string} name event name\n\t * @param {HTMLElement} fromElement\n\t * @param {HTMLElement} toElement\n\t * @param {boolean} [capture=false]\n\t * @returns {function} callback\n\t */\n\tfunction forwardingEvents(name, fromElement, toElement) {\n\t    var capture = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n\t\n\t    var callback = function callback(event) {\n\t        dispatch(toElement, name, {\n\t            bubbles: event.bubbles,\n\t            cancelable: event.cancelable,\n\t            detail: event.detail\n\t        });\n\t    };\n\t\n\t    callback.cancel = function () {\n\t        fromElement.removeEventListener(name, callback, capture);\n\t    };\n\t\n\t    fromElement.addEventListener(name, callback, capture);\n\t\n\t    return callback;\n\t}\n\t\n\texports.Custom = Custom;\n\texports.dispatch = dispatch;\n\texports.forwardingEvents = forwardingEvents;\n\n/***/ },\n/* 16 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar context = __webpack_require__(6);\n\t\n\t/**\n\t * @constant {Document}\n\t * @private\n\t */\n\tvar doc = context.document;\n\t\n\t/**\n\t * @constant {Object}\n\t * @private\n\t */\n\tvar protoEvent = context.Event.prototype;\n\t\n\tvar issetCustomEvent = false;\n\t\n\ttry {\n\t    issetCustomEvent = Boolean(doc.createEvent('CustomEvent'));\n\t} catch (e) {}\n\t// do nothing\n\t\n\t\n\t/**\n\t * The original function \"stopImmediatePropagation\"\n\t * @constant {function}\n\t * @private\n\t */\n\tvar stopImmediatePropagation = protoEvent.stopImmediatePropagation;\n\t\n\t/**\n\t * Override function to set properties \"immediatePropagationStopped\"\n\t */\n\tprotoEvent.stopImmediatePropagation = function () {\n\t    this.immediatePropagationStopped = true;\n\t\n\t    if (stopImmediatePropagation) {\n\t        stopImmediatePropagation.call(this);\n\t    } else {\n\t        this.stopPropagation();\n\t    }\n\t};\n\t\n\tvar CustomEventCommon = function () {\n\t    if (issetCustomEvent) {\n\t        return function (eventName, params) {\n\t            params = params || {};\n\t\n\t            var bubbles = Boolean(params.bubbles);\n\t            var cancelable = Boolean(params.cancelable);\n\t            var evt = doc.createEvent('CustomEvent');\n\t\n\t            evt.initCustomEvent(eventName, bubbles, cancelable, params.detail);\n\t\n\t            return evt;\n\t        };\n\t    }\n\t\n\t    return function (eventName, params) {\n\t        params = params || {};\n\t\n\t        var bubbles = Boolean(params.bubbles);\n\t        var cancelable = Boolean(params.cancelable);\n\t        var evt = doc.createEvent('Event');\n\t\n\t        evt.initEvent(eventName, bubbles, cancelable);\n\t        evt.detail = params.detail;\n\t\n\t        return evt;\n\t    };\n\t}();\n\t\n\tCustomEventCommon.prototype = protoEvent;\n\t\n\tmodule.exports = CustomEventCommon;\n\n/***/ },\n/* 17 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar select = __webpack_require__(11);\n\tvar bubbleset = __webpack_require__(9);\n\t\n\tvar _require = __webpack_require__(18);\n\t\n\tvar CLS = _require.CLS;\n\t\n\t\n\tvar currentDragSet = null;\n\t\n\texports.init = function (nodeSet) {\n\t    nodeSet.addEventListener('drop', onDrop);\n\t    nodeSet.addEventListener('dragover', onDragover);\n\t    nodeSet.addEventListener('dragenter', onDragenter);\n\t    nodeSet.addEventListener('dragleave', onDragleave);\n\t    nodeSet.addEventListener('dragstart', onDragstart);\n\t    nodeSet.addEventListener('dragend', onDragend);\n\t};\n\t\n\texports.destroy = function (nodeSet) {\n\t    nodeSet.removeEventListener('drop', onDrop);\n\t    nodeSet.removeEventListener('dragover', onDragover);\n\t    nodeSet.removeEventListener('dragenter', onDragenter);\n\t    nodeSet.removeEventListener('dragleave', onDragleave);\n\t    nodeSet.removeEventListener('dragstart', onDragstart);\n\t    nodeSet.removeEventListener('dragend', onDragend);\n\t};\n\t\n\tfunction onDragstart(event) {\n\t    event.stopPropagation();\n\t\n\t    var nodeSet = bubbleset.closestNodeSet(event.target);\n\t    var nodeBubble = bubbleset.closestNodeBubble(event.target);\n\t\n\t    if (!nodeSet || !nodeBubble) {\n\t        event.preventDefault();\n\t        return;\n\t    }\n\t\n\t    currentDragSet = nodeSet;\n\t    nodeSet.classList.add(CLS.DRAGSTART);\n\t    select.add(nodeBubble);\n\t\n\t    event.dataTransfer.effectAllowed = 'move';\n\t    event.dataTransfer.setData('text/plain', '');\n\t}\n\t\n\tfunction onDrop(event) {\n\t    event.stopPropagation();\n\t    event.preventDefault();\n\t\n\t    if (!currentDragSet) {\n\t        return;\n\t    }\n\t\n\t    var nodeSet = bubbleset.closestNodeSet(event.target);\n\t\n\t    if (!nodeSet || nodeSet === currentDragSet) {\n\t        return;\n\t    }\n\t\n\t    var list = select.get(currentDragSet);\n\t\n\t    if (!list.length) {\n\t        return;\n\t    }\n\t\n\t    list.forEach(function (item) {\n\t        return nodeSet.appendChild(item);\n\t    });\n\t    nodeSet.focus();\n\t}\n\t\n\tfunction onDragover(event) {\n\t    event.stopPropagation();\n\t    event.preventDefault();\n\t\n\t    if (!currentDragSet) {\n\t        return;\n\t    }\n\t\n\t    event.dataTransfer.dropEffect = 'move';\n\t}\n\t\n\tfunction onDragenter(event) {\n\t    event.stopPropagation();\n\t    event.preventDefault();\n\t\n\t    if (!currentDragSet) {\n\t        return;\n\t    }\n\t\n\t    var nodeSet = bubbleset.closestNodeSet(event.target);\n\t\n\t    if (!nodeSet || nodeSet === currentDragSet) {\n\t        return;\n\t    }\n\t\n\t    nodeSet.classList.add(CLS.DROPZONE);\n\t}\n\t\n\tfunction onDragleave(event) {\n\t    event.stopPropagation();\n\t    event.preventDefault();\n\t\n\t    if (!currentDragSet) {\n\t        return;\n\t    }\n\t\n\t    var nodeSet = bubbleset.closestNodeSet(event.target);\n\t\n\t    if (!nodeSet || nodeSet === currentDragSet) {\n\t        return;\n\t    }\n\t\n\t    nodeSet.classList.remove(CLS.DROPZONE);\n\t}\n\t\n\tfunction onDragend(event) {\n\t    event.stopPropagation();\n\t    event.preventDefault();\n\t\n\t    if (!currentDragSet) {\n\t        return;\n\t    }\n\t\n\t    currentDragSet.classList.remove(CLS.DRAGSTART);\n\t\n\t    var nodeSet = bubbleset.closestNodeSet(event.target);\n\t\n\t    if (nodeSet && nodeSet !== currentDragSet) {\n\t        nodeSet.classList.remove(CLS.DROPZONE);\n\t    }\n\t\n\t    currentDragSet = null;\n\t}\n\n/***/ },\n/* 18 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\texports.KEY = {\n\t    a: 65,\n\t    Backspace: 8,\n\t    Bottom: 40,\n\t    Comma: 44, // ,\n\t    Enter: 13, // Enter\n\t    Left: 37,\n\t    Right: 39,\n\t    Semicolon: 59, // ;\n\t    Tab: 9,\n\t    Top: 38\n\t};\n\t\n\texports.CLS = {\n\t    DRAGSTART: 'drag',\n\t    DROPZONE: 'dropzone'\n\t};\n\t\n\texports.EV = {\n\t    BUBBLE_INPUT: 'bubble-input',\n\t    CHANGE: 'change'\n\t};\n\n/***/ },\n/* 19 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar bubbleset = __webpack_require__(9);\n\tvar bubble = __webpack_require__(8);\n\tvar cursor = __webpack_require__(12);\n\tvar select = __webpack_require__(11);\n\t\n\tvar _require = __webpack_require__(18);\n\t\n\tvar KEY = _require.KEY;\n\t\n\tvar context = __webpack_require__(6);\n\tvar text = __webpack_require__(7);\n\t\n\tvar slice = Array.prototype.slice;\n\t\n\texports.init = function (nodeSet) {\n\t    nodeSet.addEventListener('keyup', keyup);\n\t    nodeSet.addEventListener('keydown', keydown);\n\t    nodeSet.addEventListener('keypress', keypress);\n\t    nodeSet.addEventListener('paste', paste);\n\t};\n\t\n\texports.destroy = function (nodeSet) {\n\t    nodeSet.removeEventListener('keyup', keyup);\n\t    nodeSet.removeEventListener('keydown', keydown);\n\t    nodeSet.removeEventListener('keypress', keypress);\n\t    nodeSet.removeEventListener('paste', paste);\n\t};\n\t\n\tfunction keyup(event) {\n\t    event.currentTarget.fireInput();\n\t}\n\t\n\tfunction keypress(event) {\n\t    var code = event.charCode || event.keyCode;\n\t    var nodeSet = event.currentTarget;\n\t\n\t    /* eslint no-case-declarations: 0 */\n\t    switch (code) {\n\t        case KEY.Enter:\n\t        case KEY.Comma:\n\t        case KEY.Semicolon:\n\t            event.preventDefault();\n\t\n\t            if (nodeSet.hasAttribute('disable-controls')) {\n\t                return;\n\t            }\n\t\n\t            bubble.bubbling(nodeSet);\n\t            cursor.restore(nodeSet);\n\t            break;\n\t    }\n\t}\n\t\n\tfunction keydown(event) {\n\t    var code = event.charCode || event.keyCode;\n\t    var metaKey = event.metaKey;\n\t    var nodeSet = event.currentTarget;\n\t    var enable = !nodeSet.hasAttribute('disable-controls');\n\t\n\t    switch (code) {\n\t        case KEY.Backspace:\n\t            event.preventDefault();\n\t            backSpace(event);\n\t            break;\n\t\n\t        case KEY.Left:\n\t            event.preventDefault();\n\t            arrowLeft(event);\n\t            break;\n\t\n\t        // сдвигаем курсор в начало списка\n\t        case KEY.Top:\n\t            event.preventDefault();\n\t            if (enable) {\n\t                var headBubble = bubbleset.headBubble(nodeSet);\n\t                headBubble && select.uniq(headBubble);\n\t            }\n\t            break;\n\t\n\t        case KEY.Right:\n\t            event.preventDefault();\n\t            arrowRight(event);\n\t            break;\n\t\n\t        // сдвигаем курсор в конец списка\n\t        case KEY.Tab:\n\t        case KEY.Bottom:\n\t            event.preventDefault();\n\t            if (enable && select.has(nodeSet)) {\n\t                cursor.restore(nodeSet);\n\t            }\n\t            break;\n\t\n\t        case KEY.a:\n\t            if (metaKey) {\n\t                event.preventDefault();\n\t\n\t                if (!text.selectAll(null, event.currentTarget)) {\n\t                    select.all(nodeSet);\n\t                }\n\t            }\n\t            break;\n\t    }\n\t}\n\t\n\tfunction arrowLeft(event) {\n\t    var selection = context.getSelection();\n\t\n\t    if (text.arrowLeft(selection, event.shiftKey)) {\n\t        return;\n\t    }\n\t\n\t    if (selection.anchorNode && selection.anchorNode.nodeType === Node.TEXT_NODE) {\n\t        var nodeBubble = bubbleset.prevBubble(selection.anchorNode);\n\t        nodeBubble && select.uniq(nodeBubble);\n\t        return;\n\t    }\n\t\n\t    var nodeSet = event.currentTarget;\n\t    var list = select.get(nodeSet);\n\t    var begin = list.length > 1 && list[0] === nodeSet.startRangeSelect ? list[list.length - 1] : list[0];\n\t\n\t    var node = bubbleset.prevBubble(begin);\n\t\n\t    if (node) {\n\t        if (event.shiftKey) {\n\t            select.range(node);\n\t        } else {\n\t            select.uniq(node);\n\t        }\n\t    }\n\t}\n\t\n\tfunction arrowRight(event) {\n\t    var selection = context.getSelection();\n\t\n\t    if (text.arrowRight(selection, event.shiftKey)) {\n\t        return;\n\t    }\n\t\n\t    if (selection.focusNode && selection.focusNode.nodeType === Node.TEXT_NODE) {\n\t        var nodeBubble = bubbleset.nextBubble(selection.focusNode);\n\t        nodeBubble && select.uniq(nodeBubble);\n\t        return;\n\t    }\n\t\n\t    var nodeSet = event.currentTarget;\n\t    var list = select.get(nodeSet);\n\t    var begin = list.length > 1 && list[list.length - 1] === nodeSet.startRangeSelect ? list[0] : list[list.length - 1];\n\t\n\t    var node = bubbleset.nextBubble(begin);\n\t\n\t    if (node) {\n\t        if (event.shiftKey) {\n\t            select.range(node);\n\t        } else {\n\t            select.uniq(node);\n\t        }\n\t    } else if (begin && begin.nextSibling && begin.nextSibling.nodeType === Node.TEXT_NODE) {\n\t        select.clear(nodeSet);\n\t        selection.collapse(begin.nextSibling, 0);\n\t    } else {\n\t        cursor.restore(nodeSet);\n\t    }\n\t}\n\t\n\tfunction backSpace(event) {\n\t    var nodeSet = event.currentTarget;\n\t    nodeSet.normalize();\n\t\n\t    var selection = context.getSelection();\n\t    if (!selection) {\n\t        return;\n\t    }\n\t\n\t    if (selection.isCollapsed) {\n\t        if (text.arrowLeft(selection, true)) {\n\t            text.remove(selection);\n\t            nodeSet.fireInput();\n\t            return;\n\t        }\n\t    } else {\n\t        text.remove(selection);\n\t        nodeSet.fireInput();\n\t        return;\n\t    }\n\t\n\t    var node = bubbleset.findBubbleLeft(selection);\n\t    if (node) {\n\t        select.uniq(node);\n\t        return;\n\t    }\n\t\n\t    var list = select.get(nodeSet);\n\t\n\t    if (list.length) {\n\t        var prevBubble = list[0].previousSibling;\n\t        var nextBubble = list[list.length - 1].nextSibling;\n\t        list.forEach(function (item) {\n\t            return item.parentNode.removeChild(item);\n\t        });\n\t\n\t        if (bubble.isBubbleNode(prevBubble)) {\n\t            select.uniq(prevBubble);\n\t        } else if (bubble.isBubbleNode(nextBubble)) {\n\t            select.uniq(nextBubble);\n\t        } else {\n\t            nodeSet.focus();\n\t            cursor.restore(nodeSet);\n\t            nodeSet.fireChange();\n\t        }\n\t    }\n\t}\n\t\n\tfunction paste(event) {\n\t    event.preventDefault();\n\t\n\t    var clipboardData = event.clipboardData;\n\t    if (!clipboardData) {\n\t        return;\n\t    }\n\t\n\t    var contentType = 'text/plain';\n\t    var data = clipboardData.getData && clipboardData.getData(contentType);\n\t\n\t    if (!text.replaceString(data) && clipboardData.items) {\n\t        slice.call(clipboardData.items).filter(function (item) {\n\t            return item.kind === 'string' && item.type === contentType;\n\t        }).some(function (item) {\n\t            item.getAsString(text.replaceString);\n\t            return true;\n\t        });\n\t    }\n\t}\n\n/***/ }\n/******/ ]);\n\n\n/** WEBPACK FOOTER **\n ** x-bubbles.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 2a125afad805ec42ecdd\n **/","const raf = require('raf');\nconst events = require('./core/events');\nconst { dispatch } = require('./core/event');\nconst drag = require('./core/drag');\nconst editor = require('./core/editor');\nconst bubble = require('./core/bubble');\nconst bubbleset = require('./core/bubbleset');\nconst text = require('./core/text');\nconst cursor = require('./core/cursor');\nconst { EV } = require('./core/constant');\n\nconst XBubbles = Object.create(HTMLElement.prototype, {\n    createdCallback: {\n        value: function () {\n            this.setAttribute('contenteditable', 'true');\n            this.setAttribute('spellcheck', 'false');\n\n            this.fireInput = throttleRaf(fireInput, this);\n            this.fireChange = throttleRaf(fireChange, this);\n        }\n    },\n\n    attachedCallback: {\n        value: function () {\n            this.addEventListener('focus', events.focus);\n            this.addEventListener('blur', events.blur);\n            this.addEventListener('click', events.click);\n            this.addEventListener('dblclick', events.dblclick);\n\n            drag.init(this);\n            editor.init(this);\n            bubble.bubbling(this);\n        }\n    },\n\n    detachedCallback: {\n        value: function () {\n            this.removeEventListener('focus', events.focus);\n            this.removeEventListener('blur', events.blur);\n            this.removeEventListener('click', events.click);\n            this.removeEventListener('dblclick', events.dblclick);\n\n            drag.destroy(this);\n            editor.destroy(this);\n        }\n    },\n\n    /*\n    attributeChangedCallback: {\n        value: function (name, prevValue, value) {}\n    },\n    */\n\n    options: {\n        value: function (name, value) {\n            if (!this._options) {\n                this._options = {\n                    classBubble: 'bubble',\n                    draggable: true,\n                    separator: /[,;]/,\n                    ending: null, // /\\@ya\\.ru/g;\n                    begining: null,\n                    bubbleFormation: function () {},\n                    bubbleDeformation: function () {},\n                    ...this.dataset\n                };\n\n                optionsPrepare(this._options);\n            }\n\n            if (typeof value !== 'undefined') {\n                this._options[ name ] = value;\n                optionsPrepare(this._options);\n\n            } else {\n                return this._options[ name ];\n            }\n        }\n    },\n\n    items: {\n        get: function () {\n            return bubbleset.getBubbles(this);\n        }\n    },\n\n    innerText: {\n        get: function () {\n            return '';\n        },\n\n        set: function (value) {\n            while (this.firstChild) {\n                this.removeChild(this.firstChild);\n            }\n\n            value = text.html2text(value);\n            this.appendChild(document.createTextNode(value));\n            bubble.bubbling(this);\n        }\n    },\n\n    innerHTML: {\n        get: function () {\n            return '';\n        },\n\n        set: function (value) {\n            while (this.firstChild) {\n                this.removeChild(this.firstChild);\n            }\n\n            value = text.html2text(value);\n            this.appendChild(document.createTextNode(value));\n            bubble.bubbling(this);\n        }\n    },\n\n    addBubble: {\n        value: function (bubbleText, data) {\n            const nodeBubble = bubble.create(this, bubbleText, data);\n\n            if (!nodeBubble) {\n                return;\n            }\n\n            text.text2bubble(this, nodeBubble);\n            cursor.restore(this);\n        }\n    }\n});\n\nmodule.exports = document.registerElement('x-bubbles', {\n    extends: 'div',\n    prototype: XBubbles\n});\n\nmodule.exports = XBubbles;\n\nfunction optionsPrepare(options) {\n    const typeBubbleFormation = typeof options.bubbleFormation;\n    const typeBubbleDeformation = typeof options.bubbleDeformation;\n\n    switch (typeBubbleFormation) {\n    case 'string':\n        options.bubbleFormation = new Function('wrap', `(function(wrap) { ${options.bubbleFormation}(wrap); }(wrap));`);\n        break;\n    case 'function':\n        break;\n    default:\n        options.bubbleFormation = function () {};\n    }\n\n    switch (typeBubbleDeformation) {\n    case 'string':\n        options.bubbleDeformation = new Function('wrap', `return (function(wrap) { return ${options.bubbleDeformation}(wrap); }(wrap));`);\n        break;\n    case 'function':\n        break;\n    default:\n        options.bubbleDeformation = function () {};\n    }\n}\n\nfunction fireChange() {\n    dispatch(this, EV.CHANGE, {\n        bubbles: false,\n        cancelable: false\n    });\n}\n\nfunction fireInput() {\n    const textRange = text.currentTextRange();\n    if (textRange) {\n        const editText = text.textClean(textRange.toString());\n\n        if (this._bubbleValue !== editText) {\n            this._bubbleValue = editText;\n\n            dispatch(this, EV.BUBBLE_INPUT, {\n                bubbles: false,\n                cancelable: false,\n                detail: { data: editText }\n            });\n        }\n    }\n}\n\nfunction throttleRaf(callback, context) {\n    let throttle = 0;\n    const animationCallback = function () {\n        throttle = 0;\n    };\n\n    return function () {\n        if (throttle) {\n            return;\n        }\n\n        throttle = raf(animationCallback);\n\n        callback.apply(context || this, arguments);\n    };\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./index.js\n **/","var now = require('performance-now')\n  , root = typeof window === 'undefined' ? global : window\n  , vendors = ['moz', 'webkit']\n  , suffix = 'AnimationFrame'\n  , raf = root['request' + suffix]\n  , caf = root['cancel' + suffix] || root['cancelRequest' + suffix]\n\nfor(var i = 0; !raf && i < vendors.length; i++) {\n  raf = root[vendors[i] + 'Request' + suffix]\n  caf = root[vendors[i] + 'Cancel' + suffix]\n      || root[vendors[i] + 'CancelRequest' + suffix]\n}\n\n// Some versions of FF have rAF but not cAF\nif(!raf || !caf) {\n  var last = 0\n    , id = 0\n    , queue = []\n    , frameDuration = 1000 / 60\n\n  raf = function(callback) {\n    if(queue.length === 0) {\n      var _now = now()\n        , next = Math.max(0, frameDuration - (_now - last))\n      last = next + _now\n      setTimeout(function() {\n        var cp = queue.slice(0)\n        // Clear queue here to prevent\n        // callbacks from appending listeners\n        // to the current frame's queue\n        queue.length = 0\n        for(var i = 0; i < cp.length; i++) {\n          if(!cp[i].cancelled) {\n            try{\n              cp[i].callback(last)\n            } catch(e) {\n              setTimeout(function() { throw e }, 0)\n            }\n          }\n        }\n      }, Math.round(next))\n    }\n    queue.push({\n      handle: ++id,\n      callback: callback,\n      cancelled: false\n    })\n    return id\n  }\n\n  caf = function(handle) {\n    for(var i = 0; i < queue.length; i++) {\n      if(queue[i].handle === handle) {\n        queue[i].cancelled = true\n      }\n    }\n  }\n}\n\nmodule.exports = function(fn) {\n  // Wrap in a new function to prevent\n  // `cancel` potentially being assigned\n  // to the native rAF function\n  return raf.call(root, fn)\n}\nmodule.exports.cancel = function() {\n  caf.apply(root, arguments)\n}\nmodule.exports.polyfill = function() {\n  root.requestAnimationFrame = raf\n  root.cancelAnimationFrame = caf\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ../~/raf/index.js\n ** module id = 1\n ** module chunks = 0\n **/","// Generated by CoffeeScript 1.7.1\n(function() {\n  var getNanoSeconds, hrtime, loadTime;\n\n  if ((typeof performance !== \"undefined\" && performance !== null) && performance.now) {\n    module.exports = function() {\n      return performance.now();\n    };\n  } else if ((typeof process !== \"undefined\" && process !== null) && process.hrtime) {\n    module.exports = function() {\n      return (getNanoSeconds() - loadTime) / 1e6;\n    };\n    hrtime = process.hrtime;\n    getNanoSeconds = function() {\n      var hr;\n      hr = hrtime();\n      return hr[0] * 1e9 + hr[1];\n    };\n    loadTime = getNanoSeconds();\n  } else if (Date.now) {\n    module.exports = function() {\n      return Date.now() - loadTime;\n    };\n    loadTime = Date.now();\n  } else {\n    module.exports = function() {\n      return new Date().getTime() - loadTime;\n    };\n    loadTime = new Date().getTime();\n  }\n\n}).call(this);\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ../~/performance-now/lib/performance-now.js\n ** module id = 2\n ** module chunks = 0\n **/","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ../~/process/browser.js\n ** module id = 3\n ** module chunks = 0\n **/","exports.dblclick = require('./events/dblclick');\nexports.click = require('./events/click');\nexports.focus = require('./events/focus');\nexports.blur = require('./events/blur');\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/events.js\n **/","const context = require('../../context');\nconst text = require('../text');\nconst bubbleset = require('../bubbleset');\n\nmodule.exports = function (event) {\n    const nodeSet = bubbleset.closestNodeSet(event.target);\n\n    if (!nodeSet) {\n        return;\n    }\n\n    const nodeBubble = bubbleset.closestNodeBubble(event.target);\n\n    if (!nodeBubble) {\n        return;\n    }\n\n    const selection = context.getSelection();\n\n    if (!selection) {\n        return;\n    }\n\n    event.preventDefault();\n\n    const bubbleDeformation = nodeSet.options('bubbleDeformation');\n    let rangeParams = bubbleDeformation(nodeBubble);\n\n    if (!rangeParams) {\n        const dataText = text.textClean(nodeBubble.innerText);\n\n        rangeParams = {\n            text: dataText,\n            startOffset: 0,\n            endOffset: text.length\n        };\n    }\n\n    const textFake = text.createZws();\n    const textNode = context.document.createTextNode(rangeParams.text);\n\n    nodeSet.replaceChild(textNode, nodeBubble);\n    nodeSet.insertBefore(textFake, textNode);\n\n    const range = context.document.createRange();\n    range.setStart(textNode, rangeParams.startOffset);\n    range.setEnd(textNode, rangeParams.endOffset);\n\n    selection.removeAllRanges();\n    selection.addRange(range);\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/events/dblclick.js\n **/","module.exports = (function () {\n    /* eslint no-eval: 0 */\n    return this || (1, eval)('this');\n})();\n\n\n\n/** WEBPACK FOOTER **\n ** ./context.js\n **/","const context = require('../context');\nconst bubble = require('./bubble');\nconst bubbleset = require('./bubbleset');\n\n/* eslint-disable max-len */\nconst REG_REPLACE_NON_PRINTABLE = /[\\0-\\x1F\\x7F-\\x9F\\xAD\\u0378\\u0379\\u037F-\\u0383\\u038B\\u038D\\u03A2\\u0528-\\u0530\\u0557\\u0558\\u0560\\u0588\\u058B-\\u058E\\u0590\\u05C8-\\u05CF\\u05EB-\\u05EF\\u05F5-\\u0605\\u061C\\u061D\\u06DD\\u070E\\u070F\\u074B\\u074C\\u07B2-\\u07BF\\u07FB-\\u07FF\\u082E\\u082F\\u083F\\u085C\\u085D\\u085F-\\u089F\\u08A1\\u08AD-\\u08E3\\u08FF\\u0978\\u0980\\u0984\\u098D\\u098E\\u0991\\u0992\\u09A9\\u09B1\\u09B3-\\u09B5\\u09BA\\u09BB\\u09C5\\u09C6\\u09C9\\u09CA\\u09CF-\\u09D6\\u09D8-\\u09DB\\u09DE\\u09E4\\u09E5\\u09FC-\\u0A00\\u0A04\\u0A0B-\\u0A0E\\u0A11\\u0A12\\u0A29\\u0A31\\u0A34\\u0A37\\u0A3A\\u0A3B\\u0A3D\\u0A43-\\u0A46\\u0A49\\u0A4A\\u0A4E-\\u0A50\\u0A52-\\u0A58\\u0A5D\\u0A5F-\\u0A65\\u0A76-\\u0A80\\u0A84\\u0A8E\\u0A92\\u0AA9\\u0AB1\\u0AB4\\u0ABA\\u0ABB\\u0AC6\\u0ACA\\u0ACE\\u0ACF\\u0AD1-\\u0ADF\\u0AE4\\u0AE5\\u0AF2-\\u0B00\\u0B04\\u0B0D\\u0B0E\\u0B11\\u0B12\\u0B29\\u0B31\\u0B34\\u0B3A\\u0B3B\\u0B45\\u0B46\\u0B49\\u0B4A\\u0B4E-\\u0B55\\u0B58-\\u0B5B\\u0B5E\\u0B64\\u0B65\\u0B78-\\u0B81\\u0B84\\u0B8B-\\u0B8D\\u0B91\\u0B96-\\u0B98\\u0B9B\\u0B9D\\u0BA0-\\u0BA2\\u0BA5-\\u0BA7\\u0BAB-\\u0BAD\\u0BBA-\\u0BBD\\u0BC3-\\u0BC5\\u0BC9\\u0BCE\\u0BCF\\u0BD1-\\u0BD6\\u0BD8-\\u0BE5\\u0BFB-\\u0C00\\u0C04\\u0C0D\\u0C11\\u0C29\\u0C34\\u0C3A-\\u0C3C\\u0C45\\u0C49\\u0C4E-\\u0C54\\u0C57\\u0C5A-\\u0C5F\\u0C64\\u0C65\\u0C70-\\u0C77\\u0C80\\u0C81\\u0C84\\u0C8D\\u0C91\\u0CA9\\u0CB4\\u0CBA\\u0CBB\\u0CC5\\u0CC9\\u0CCE-\\u0CD4\\u0CD7-\\u0CDD\\u0CDF\\u0CE4\\u0CE5\\u0CF0\\u0CF3-\\u0D01\\u0D04\\u0D0D\\u0D11\\u0D3B\\u0D3C\\u0D45\\u0D49\\u0D4F-\\u0D56\\u0D58-\\u0D5F\\u0D64\\u0D65\\u0D76-\\u0D78\\u0D80\\u0D81\\u0D84\\u0D97-\\u0D99\\u0DB2\\u0DBC\\u0DBE\\u0DBF\\u0DC7-\\u0DC9\\u0DCB-\\u0DCE\\u0DD5\\u0DD7\\u0DE0-\\u0DF1\\u0DF5-\\u0E00\\u0E3B-\\u0E3E\\u0E5C-\\u0E80\\u0E83\\u0E85\\u0E86\\u0E89\\u0E8B\\u0E8C\\u0E8E-\\u0E93\\u0E98\\u0EA0\\u0EA4\\u0EA6\\u0EA8\\u0EA9\\u0EAC\\u0EBA\\u0EBE\\u0EBF\\u0EC5\\u0EC7\\u0ECE\\u0ECF\\u0EDA\\u0EDB\\u0EE0-\\u0EFF\\u0F48\\u0F6D-\\u0F70\\u0F98\\u0FBD\\u0FCD\\u0FDB-\\u0FFF\\u10C6\\u10C8-\\u10CC\\u10CE\\u10CF\\u1249\\u124E\\u124F\\u1257\\u1259\\u125E\\u125F\\u1289\\u128E\\u128F\\u12B1\\u12B6\\u12B7\\u12BF\\u12C1\\u12C6\\u12C7\\u12D7\\u1311\\u1316\\u1317\\u135B\\u135C\\u137D-\\u137F\\u139A-\\u139F\\u13F5-\\u13FF\\u169D-\\u169F\\u16F1-\\u16FF\\u170D\\u1715-\\u171F\\u1737-\\u173F\\u1754-\\u175F\\u176D\\u1771\\u1774-\\u177F\\u17DE\\u17DF\\u17EA-\\u17EF\\u17FA-\\u17FF\\u180F\\u181A-\\u181F\\u1878-\\u187F\\u18AB-\\u18AF\\u18F6-\\u18FF\\u191D-\\u191F\\u192C-\\u192F\\u193C-\\u193F\\u1941-\\u1943\\u196E\\u196F\\u1975-\\u197F\\u19AC-\\u19AF\\u19CA-\\u19CF\\u19DB-\\u19DD\\u1A1C\\u1A1D\\u1A5F\\u1A7D\\u1A7E\\u1A8A-\\u1A8F\\u1A9A-\\u1A9F\\u1AAE-\\u1AFF\\u1B4C-\\u1B4F\\u1B7D-\\u1B7F\\u1BF4-\\u1BFB\\u1C38-\\u1C3A\\u1C4A-\\u1C4C\\u1C80-\\u1CBF\\u1CC8-\\u1CCF\\u1CF7-\\u1CFF\\u1DE7-\\u1DFB\\u1F16\\u1F17\\u1F1E\\u1F1F\\u1F46\\u1F47\\u1F4E\\u1F4F\\u1F58\\u1F5A\\u1F5C\\u1F5E\\u1F7E\\u1F7F\\u1FB5\\u1FC5\\u1FD4\\u1FD5\\u1FDC\\u1FF0\\u1FF1\\u1FF5\\u1FFF\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u206F\\u2072\\u2073\\u208F\\u209D-\\u209F\\u20BB-\\u20CF\\u20F1-\\u20FF\\u218A-\\u218F\\u23F4-\\u23FF\\u2427-\\u243F\\u244B-\\u245F\\u2700\\u2B4D-\\u2B4F\\u2B5A-\\u2BFF\\u2C2F\\u2C5F\\u2CF4-\\u2CF8\\u2D26\\u2D28-\\u2D2C\\u2D2E\\u2D2F\\u2D68-\\u2D6E\\u2D71-\\u2D7E\\u2D97-\\u2D9F\\u2DA7\\u2DAF\\u2DB7\\u2DBF\\u2DC7\\u2DCF\\u2DD7\\u2DDF\\u2E3C-\\u2E7F\\u2E9A\\u2EF4-\\u2EFF\\u2FD6-\\u2FEF\\u2FFC-\\u2FFF\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312E-\\u3130\\u318F\\u31BB-\\u31BF\\u31E4-\\u31EF\\u321F\\u32FF\\u4DB6-\\u4DBF\\u9FCD-\\u9FFF\\uA48D-\\uA48F\\uA4C7-\\uA4CF\\uA62C-\\uA63F\\uA698-\\uA69E\\uA6F8-\\uA6FF\\uA78F\\uA794-\\uA79F\\uA7AB-\\uA7F7\\uA82C-\\uA82F\\uA83A-\\uA83F\\uA878-\\uA87F\\uA8C5-\\uA8CD\\uA8DA-\\uA8DF\\uA8FC-\\uA8FF\\uA954-\\uA95E\\uA97D-\\uA97F\\uA9CE\\uA9DA-\\uA9DD\\uA9E0-\\uA9FF\\uAA37-\\uAA3F\\uAA4E\\uAA4F\\uAA5A\\uAA5B\\uAA7C-\\uAA7F\\uAAC3-\\uAADA\\uAAF7-\\uAB00\\uAB07\\uAB08\\uAB0F\\uAB10\\uAB17-\\uAB1F\\uAB27\\uAB2F-\\uABBF\\uABEE\\uABEF\\uABFA-\\uABFF\\uD7A4-\\uD7AF\\uD7C7-\\uD7CA\\uD7FC-\\uF8FF\\uFA6E\\uFA6F\\uFADA-\\uFAFF\\uFB07-\\uFB12\\uFB18-\\uFB1C\\uFB37\\uFB3D\\uFB3F\\uFB42\\uFB45\\uFBC2-\\uFBD2\\uFD40-\\uFD4F\\uFD90\\uFD91\\uFDC8-\\uFDEF\\uFDFE\\uFDFF\\uFE1A-\\uFE1F\\uFE27-\\uFE2F\\uFE53\\uFE67\\uFE6C-\\uFE6F\\uFE75\\uFEFD-\\uFF00\\uFFBF-\\uFFC1\\uFFC8\\uFFC9\\uFFD0\\uFFD1\\uFFD8\\uFFD9\\uFFDD-\\uFFDF\\uFFE7\\uFFEF-\\uFFFB\\uFFFE\\uFFFF]/g;\nconst REG_ZWS = /\\u200B/;\nconst TEXT_ZWS = '\\u200B';\n\nexports.arrowRight = arrowRight;\nexports.arrowLeft = arrowLeft;\nexports.remove = remove;\nexports.html2text = html2text;\nexports.currentTextRange = currentTextRange;\nexports.text2bubble = text2bubble;\nexports.replaceString = replaceString;\nexports.selectAll = selectAll;\nexports.textClean = textClean;\nexports.checkZws = checkZws;\nexports.createZws = createZws;\n\nfunction text2bubble(nodeSet, nodeBubble, selection) {\n    selection = selection || context.getSelection();\n\n    if (!selection) {\n        return false;\n    }\n\n    const range = currentTextRange(selection);\n\n    if (!range) {\n        return false;\n    }\n\n    if (!nodeBubble) {\n        nodeBubble = bubble.create(nodeSet, range.toString());\n    }\n\n    if (!nodeBubble) {\n        return false;\n    }\n\n    selection.removeAllRanges();\n    selection.addRange(range);\n\n    replace(selection, nodeBubble);\n    return true;\n}\n\nfunction currentTextRange(selection) {\n    selection = selection || context.getSelection();\n\n    if (!selection) {\n        return;\n    }\n\n    const pointNode = do {\n        if (selection.focusNode && selection.focusNode.nodeType === Node.TEXT_NODE) {\n            selection.focusNode;\n\n        } else if (selection.anchorNode && selection.anchorNode.nodeType === Node.TEXT_NODE) {\n            selection.anchorNode;\n\n        } else {\n            undefined;\n        }\n    };\n\n    if (!pointNode) {\n        return;\n    }\n\n    const range = context.document.createRange();\n    let startNode = pointNode;\n    let endNode = pointNode;\n    let item = pointNode;\n\n    while (item && item.nodeType === Node.TEXT_NODE) {\n        startNode = item;\n        item = item.previousSibling;\n    }\n\n    item = pointNode;\n\n    while (item && item.nodeType === Node.TEXT_NODE) {\n        endNode = item;\n        item = item.nextSibling;\n    }\n\n    range.setStartBefore(startNode);\n    range.setEndAfter(endNode);\n\n    return range;\n}\n\nfunction remove(selection) {\n    return replace(selection, createZws());\n}\n\nfunction replace(selection, node) {\n    selection = selection || context.getSelection();\n\n    if (!selection || !selection.rangeCount) {\n        return false;\n    }\n\n    const anchor = context.document.createElement('span');\n    selection.getRangeAt(0).surroundContents(anchor);\n    anchor.parentNode.replaceChild(node, anchor);\n\n    selection.removeAllRanges();\n    selection.collapse(node, 0);\n\n    return true;\n}\n\nfunction replaceString(data, selection) {\n    data = textClean(data);\n    if (!data) {\n        return false;\n    }\n\n    selection = selection || context.getSelection();\n    const textNode = context.document.createTextNode(data);\n\n    if (!replace(selection, textNode)) {\n        return false;\n    }\n\n    selection.collapse(textNode, textNode.nodeValue.length);\n    return true;\n}\n\nfunction arrowLeft(selection, extend) {\n    selection = selection || context.getSelection();\n\n    if (!selection) {\n        return false;\n    }\n\n    if (!selection.anchorNode || selection.anchorNode.nodeType !== Node.TEXT_NODE) {\n        return false;\n    }\n\n    if (!selection.isCollapsed && !extend) {\n        let node = selection.anchorNode;\n        let offset = selection.anchorOffset;\n\n        if (selection.anchorNode === selection.focusNode) {\n            offset = Math.min(selection.anchorOffset, selection.focusOffset);\n\n        } else {\n            const position = selection.anchorNode.compareDocumentPosition(selection.focusNode);\n            if (position & Node.DOCUMENT_POSITION_FOLLOWING) {\n                offset = selection.focusOffset;\n                node = selection.focusNode;\n            }\n        }\n\n        selection.collapse(node, offset);\n        return true;\n    }\n\n    let item = selection.focusNode;\n    let offset = selection.focusOffset;\n\n    while (item) {\n        if (item.nodeType !== Node.TEXT_NODE) {\n            return false;\n        }\n\n        if (offset === null) {\n            offset = item.nodeValue.length;\n        }\n\n        if (offset - 1 < 0) {\n            item = item.previousSibling;\n            offset = null;\n            continue;\n        }\n\n        const text = item.nodeValue.substring(offset - 1, offset);\n\n        if (checkZws(text)) {\n            offset = offset - 1;\n            continue;\n        }\n\n        break;\n    }\n\n    if (!item || offset === null) {\n        return false;\n    }\n\n    if (extend) {\n        selection.extend(item, offset - 1);\n\n    } else {\n        selection.collapse(item, offset - 1);\n    }\n\n    return true;\n}\n\nfunction arrowRight(selection, extend) {\n    selection = selection || context.getSelection();\n\n    if (!selection) {\n        return false;\n    }\n\n    if (!selection.focusNode || selection.focusNode.nodeType !== Node.TEXT_NODE) {\n        return false;\n    }\n\n    if (!selection.isCollapsed && !extend) {\n        let node = selection.focusNode;\n        let offset = selection.focusOffset;\n\n        if (selection.focusNode === selection.anchorNode) {\n            offset = Math.max(selection.focusOffset, selection.anchorOffset);\n\n        } else {\n            const position = selection.anchorNode.compareDocumentPosition(selection.focusNode);\n            if (position & Node.DOCUMENT_POSITION_PRECEDING) {\n                offset = selection.anchorOffset;\n                node = selection.anchorNode;\n            }\n        }\n\n        selection.collapse(node, offset);\n        return true;\n    }\n\n    let item = selection.focusNode;\n    let offset = selection.focusOffset;\n\n    while (item) {\n        if (item.nodeType !== Node.TEXT_NODE) {\n            return false;\n        }\n\n        const len = item.nodeValue.length;\n\n        if (offset + 1 > len) {\n            item = item.nextSibling;\n            offset = 0;\n            continue;\n        }\n\n        const text = item.nodeValue.substring(offset, offset + 1);\n\n        if (checkZws(text)) {\n            offset = offset + 1;\n            continue;\n        }\n\n        break;\n    }\n\n    if (!item) {\n        return false;\n    }\n\n    if (extend) {\n        selection.extend(item, offset + 1);\n\n    } else {\n        selection.collapse(item, offset + 1);\n    }\n\n    return true;\n}\n\nfunction html2text(value) {\n    if (!value) {\n        return '';\n    }\n\n    var DOMContainer = document.implementation.createHTMLDocument('').body;\n    DOMContainer.innerText = value;\n\n    return DOMContainer.innerText\n        .replace(/^[\\u0020\\u00a0]+$/gm, '')\n        .replace(/\\n/gm, ' ')\n        .trim();\n}\n\nfunction selectAll(selection, nodeSet) {\n    selection = selection || context.getSelection();\n    const node = selection && selection.anchorNode;\n\n    if (!node || node.nodeType !== Node.TEXT_NODE) {\n        return false;\n    }\n\n    let fromNode;\n    let toNode;\n    let item = node;\n\n    while (item && item.nodeType === Node.TEXT_NODE) {\n        fromNode = item;\n        item = item.previousSibling;\n    }\n\n    item = node;\n\n    while (item && item.nodeType === Node.TEXT_NODE) {\n        toNode = item;\n        item = item.nextSibling;\n    }\n\n    const hasBubbles = bubbleset.hasBubbles(nodeSet);\n    const range = document.createRange();\n    range.setStartBefore(fromNode);\n    range.setEndAfter(toNode);\n\n    const dataText = textClean(range.toString());\n\n    if (dataText || (!dataText && !hasBubbles)) {\n        if (!dataText) {\n            range.collapse();\n        }\n\n        selection.removeAllRanges();\n        selection.addRange(range);\n        return true;\n    }\n\n    return false;\n}\n\nfunction createZws() {\n    return document.createTextNode(TEXT_ZWS);\n}\n\nfunction checkZws(value) {\n    return REG_ZWS.test(value);\n}\n\nfunction textClean(value) {\n    return String(value || '')\n        .trim()\n        .replace(REG_REPLACE_NON_PRINTABLE, '');\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/text.js\n **/","const text = require('./text');\n\nexports.isBubbleNode = isBubbleNode;\nexports.bubbling = bubbling;\nexports.create = create;\n\nfunction isBubbleNode(node) {\n    if (!node || node.nodeType !== Node.ELEMENT_NODE) {\n        return false;\n    }\n\n    return node.hasAttribute('bubble');\n}\n\nfunction create(nodeSet, dataText, data = {}) {\n    dataText = text.textClean(dataText);\n\n    if (!dataText) {\n        return;\n    }\n\n    const bubbleFormation = nodeSet.options('bubbleFormation');\n    const classBubble = nodeSet.options('classBubble');\n    const draggable = nodeSet.options('draggable');\n    const wrap = document.createElement('span');\n\n    wrap.innerText = dataText;\n\n    if (draggable) {\n        wrap.setAttribute('draggable', 'true');\n    }\n\n    for (let key in data) {\n        wrap.setAttribute(`data-${key}`, String(data[ key ]));\n    }\n\n    bubbleFormation(wrap);\n\n    wrap.classList.add(classBubble);\n    wrap.setAttribute('bubble', '');\n    wrap.setAttribute('contenteditable', 'false');\n\n    return wrap;\n}\n\nfunction bubbling(nodeSet) {\n    const separator = nodeSet.options('separator');\n    const ending = nodeSet.options('ending');\n    const begining = nodeSet.options('begining');\n    const ranges = getBubbleRanges(nodeSet);\n    const nodes = [];\n\n    ranges.forEach(function (range) {\n        const dataText = text.textClean(range.toString());\n\n        if (!dataText) {\n            range.deleteContents();\n            return;\n        }\n\n        let textParts = [ dataText ];\n\n        if (separator) {\n            textParts = dataText\n                .split(separator)\n                .map(trimIterator)\n                .filter(nonEmptyIterator);\n        }\n\n        if (ending) {\n            textParts = textParts\n                .reduce((parts, str) => parts.concat(parseFragmentByEnding(str, ending)), [])\n                .map(trimIterator)\n                .filter(nonEmptyIterator);\n\n        } else if (begining) {\n            textParts = textParts\n                .reduce((parts, str) => parts.concat(parseFragmentByBeginning(str, begining)), [])\n                .map(trimIterator)\n                .filter(nonEmptyIterator);\n        }\n\n        if (!textParts.length) {\n            range.deleteContents();\n        }\n\n        const fragment = document.createDocumentFragment();\n\n        textParts.forEach(function (textPart) {\n            const nodeBubble = create(nodeSet, textPart);\n            if (nodeBubble) {\n                fragment.appendChild(nodeBubble);\n                nodes.push(nodeBubble);\n            }\n        });\n\n        range.deleteContents();\n        range.insertNode(fragment);\n    });\n\n    nodeSet.fireChange();\n    return nodes;\n}\n\nfunction getBubbleRanges(set) {\n    let i;\n    let rng;\n    let node;\n    const ranges = [];\n    const children = set.childNodes;\n\n    for (i = 0; i < children.length; i++) {\n        node = children[ i ];\n\n        if (isBubbleNode(node)) {\n            if (rng) {\n                rng.setEndBefore(node);\n                ranges.push(rng);\n                rng = undefined;\n            }\n\n        } else {\n            if (!rng) {\n                rng = document.createRange();\n                rng.setStartBefore(node);\n            }\n        }\n    }\n\n    if (rng) {\n        rng.setEndAfter(node);\n        ranges.push(rng);\n    }\n\n    return ranges;\n}\n\nfunction trimIterator(str) {\n    return str.trim();\n}\n\nfunction nonEmptyIterator(str) {\n    return Boolean(str);\n}\n\nfunction parseFragmentByEnding(str, reg) {\n    const parts = [];\n    let lastIndex = 0;\n    let loop = 999;\n\n    reg.lastIndex = 0;\n    while (reg.exec(str) !== null && loop) {\n        loop--;\n        parts.push(str.substring(lastIndex, reg.lastIndex));\n        lastIndex = reg.lastIndex;\n    }\n\n    return parts;\n}\n\nfunction parseFragmentByBeginning(str, reg) {\n    const parts = [];\n    let res;\n    let index = 0;\n    let loop = 999;\n\n    reg.lastIndex = 0;\n    while ((res = reg.exec(str)) !== null && loop) {\n        loop--;\n        if (index !== res.index) {\n            parts.push(str.substring(index, res.index));\n            index = res.index;\n        }\n    }\n\n    parts.push(str.substring(index, str.length));\n    return parts;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/bubble.js\n **/","const bubble = require('./bubble');\nconst text = require('./text');\nconst context = require('../context');\n\nconst slice = Array.prototype.slice;\n\nexports.lastBubble = function (nodeSet) {\n    return nodeSet.querySelector('[bubble]:last-child');\n};\n\nexports.headBubble = function (nodeSet) {\n    return nodeSet.querySelector('[bubble]:first-child');\n};\n\nexports.getBubbles = function (nodeSet) {\n    return slice.call(nodeSet.querySelectorAll('[bubble]'));\n};\n\nexports.hasBubbles = function (nodeSet) {\n    return Boolean(nodeSet.querySelector('[bubble]'));\n};\n\nexports.closestNodeSet = closestNodeSet;\nexports.closestNodeBubble = closestNodeBubble;\nexports.prevBubble = prevBubble;\nexports.nextBubble = nextBubble;\n\nexports.findBubbleLeft = function (selection) {\n    selection = selection || context.getSelection();\n\n    if (!selection || !selection.focusNode) {\n        return;\n    }\n\n    let node = selection.focusNode.previousSibling;\n\n    while (node) {\n        if (bubble.isBubbleNode(node)) {\n            return node;\n        }\n\n        if (node.nodeType === Node.TEXT_NODE && text.textClean(node.nodeValue)) {\n            return;\n        }\n\n        node = node.previousSibling;\n    }\n};\n\nfunction closestNodeSet(node) {\n    while (node) {\n        if (node.nodeType === Node.ELEMENT_NODE &&\n            node.getAttribute('is') === 'x-bubbles') {\n\n            return node;\n        }\n\n        node = node.parentNode;\n    }\n}\n\nfunction closestNodeBubble(node) {\n    while (node) {\n        if (bubble.isBubbleNode(node)) {\n            return node;\n        }\n\n        node = node.parentNode;\n    }\n}\n\nfunction prevBubble(target) {\n    let node = target && target.previousSibling;\n    while (node) {\n        if (bubble.isBubbleNode(node)) {\n            return node;\n        }\n\n        node = node.previousSibling;\n    }\n}\n\nfunction nextBubble(target) {\n    let node = target && target.nextSibling;\n    while (node) {\n        if (bubble.isBubbleNode(node)) {\n            return node;\n        }\n\n        node = node.nextSibling;\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/bubbleset.js\n **/","const context = require('../../context');\nconst bubbleset = require('../bubbleset');\nconst select = require('../select');\nconst cursor = require('../cursor');\n\nmodule.exports = function (event) {\n    const nodeSet = bubbleset.closestNodeSet(event.target);\n\n    if (!nodeSet) {\n        return;\n    }\n\n    const nodeBubble = bubbleset.closestNodeBubble(event.target);\n\n    if (!nodeBubble) {\n        select.clear(nodeSet);\n\n        const selection = context.getSelection();\n\n        if (!selection ||\n            !selection.anchorNode ||\n            selection.anchorNode.nodeType !== Node.TEXT_NODE) {\n\n            cursor.restore(nodeSet);\n        }\n\n        return;\n    }\n\n    if (event.metaKey) {\n        select.add(nodeBubble);\n\n    } else if (event.shiftKey) {\n        if (!nodeSet.startRangeSelect) {\n            select.uniq(nodeBubble);\n\n        } else {\n            select.range(nodeBubble);\n        }\n\n    } else {\n        select.toggleUniq(nodeBubble);\n    }\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/events/click.js\n **/","const context = require('../context');\nconst bubble = require('./bubble');\nconst bubbleset = require('./bubbleset');\n\nconst slice = Array.prototype.slice;\nconst PATH_SELECTED = '[bubble][selected]';\nconst PATH_NOT_SELECTED = '[bubble]:not([selected])';\n\nexports.all = all;\nexports.add = add;\nexports.clear = clear;\nexports.get = get;\nexports.uniq = uniq;\nexports.head = head;\nexports.last = last;\nexports.has = has;\nexports.range = range;\nexports.toggleUniq = toggleUniq;\n\nfunction range(node) {\n    if (!bubble.isBubbleNode(node)) {\n        return;\n    }\n\n    const set = node.parentNode;\n    const list = get(set);\n\n    if (!list.length) {\n        uniq(node);\n        return;\n    }\n\n    clear(set);\n\n    const headList = list[0];\n    const lastList = list[ list.length - 1 ];\n\n    if (headList === lastList || !set.startRangeSelect) {\n        set.startRangeSelect = headList;\n    }\n\n    let fromNode;\n    let toNode;\n    const position = node.compareDocumentPosition(set.startRangeSelect);\n\n    if (position & Node.DOCUMENT_POSITION_PRECEDING) {\n        fromNode = set.startRangeSelect;\n        toNode = node;\n\n    } else {\n        fromNode = node;\n        toNode = set.startRangeSelect;\n    }\n\n    if (fromNode && toNode) {\n        let item = fromNode;\n\n        while (item) {\n            if (!setSelected(item)) {\n                break;\n            }\n\n            if (item === toNode) {\n                break;\n            }\n\n            item = item.nextSibling;\n        }\n\n        bubble.bubbling(set);\n    }\n}\n\nfunction all(nodeSet) {\n    slice.call(nodeSet.querySelectorAll(PATH_NOT_SELECTED)).forEach(item => setSelected(item));\n    nodeSet.startRangeSelect = nodeSet.querySelector(PATH_SELECTED);\n\n    bubble.bubbling(nodeSet);\n\n    const selection = context.getSelection();\n    selection && selection.removeAllRanges();\n}\n\nfunction has(nodeSet) {\n    return Boolean(nodeSet.querySelector(PATH_SELECTED));\n}\n\nfunction head(set) {\n    return get(set)[0];\n}\n\nfunction last(set) {\n    const list = get(set);\n    return list[ list.length - 1 ];\n}\n\nfunction get(nodeSet) {\n    return slice.call(nodeSet.querySelectorAll(PATH_SELECTED));\n}\n\nfunction clear(nodeSet) {\n    get(nodeSet).forEach(item => item.removeAttribute('selected'));\n}\n\nfunction add(node) {\n    if (setSelected(node)) {\n        const nodeSet = bubbleset.closestNodeSet(node);\n\n        nodeSet.startRangeSelect = node;\n        // ???\n        bubble.bubbling(nodeSet);\n\n        return true;\n    }\n\n    return false;\n}\n\nfunction uniq(node) {\n    if (!bubble.isBubbleNode(node)) {\n        return false;\n    }\n\n    const nodeSet = bubbleset.closestNodeSet(node);\n    const selection = context.getSelection();\n\n    selection && selection.removeAllRanges();\n    clear(nodeSet);\n\n    return add(node);\n}\n\nfunction toggleUniq(node) {\n    if (isSelected(node)) {\n        const nodeSet = bubbleset.closestNodeSet(node);\n\n        if (get(nodeSet).length === 1) {\n            return removeSelected(node);\n        }\n    }\n\n    return uniq(node);\n}\n\nfunction isSelected(node) {\n    return bubble.isBubbleNode(node) && node.hasAttribute('selected') || false;\n}\n\nfunction setSelected(node) {\n    if (bubble.isBubbleNode(node)) {\n        node.setAttribute('selected', '');\n        return true;\n    }\n\n    return false;\n}\n\nfunction removeSelected(node) {\n    if (bubble.isBubbleNode(node)) {\n        node.removeAttribute('selected');\n        return true;\n    }\n\n    return false;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/select.js\n **/","const context = require('../context');\nconst text = require('./text');\nconst select = require('./select');\n\nexports.restore = restore;\nexports.restoreBasis = restoreBasis;\n\nfunction restore(nodeSet) {\n    select.clear(nodeSet);\n    const basis = restoreBasis(nodeSet);\n    const selection = context.getSelection();\n    selection.removeAllRanges();\n    selection.collapse(basis, 1);\n}\n\nfunction restoreBasis(nodeSet) {\n    let fakeText = text.createZws();\n\n    if (nodeSet.hasChildNodes()) {\n        const lastNode = nodeSet.childNodes[ nodeSet.childNodes.length - 1 ];\n\n        if (lastNode.isEqualNode(fakeText)) {\n            fakeText = lastNode;\n\n        } else {\n            nodeSet.appendChild(fakeText);\n        }\n\n    } else {\n        nodeSet.appendChild(fakeText);\n    }\n\n    return fakeText;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/cursor.js\n **/","const cursor = require('../cursor');\n\nmodule.exports = function (event) {\n    cursor.restore(event.currentTarget);\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/events/focus.js\n **/","const bubble = require('../bubble');\nconst select = require('../select');\n\nmodule.exports = function (event) {\n    select.clear(event.currentTarget);\n    bubble.bubbling(event.currentTarget);\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/events/blur.js\n **/","/**\n * @module x-bubbles/event\n */\n\nconst context = require('../context');\nconst CustomEventCommon = require('../polyfills/CustomEventCommon');\n\n/**\n * Designer events.\n *\n * @example\n * const { Custom } = require('event');\n *\n * new Custom('custom-event', {\n *     bubbles: true,\n *     cancelable: true,\n *     detail: { data: '123' }\n * })\n *\n * @alias module:x-bubbles/event~Custom\n * @constructor\n */\nconst Custom = (function () {\n    if (typeof context.CustomEvent === 'function') {\n        return context.CustomEvent;\n    }\n\n    return CustomEventCommon;\n}());\n\n/**\n * Dispatch event.\n *\n * @example\n * const { dispatch } = require('event');\n * dispatch(node, 'custom-event', {\n *     bubbles: true,\n *     cancelable: true,\n *     detail: { data: '123' }\n * })\n *\n * @alias module:x-bubbles/event.dispatch\n * @param {HTMLElement} element node events\n * @param {string} name event name\n * @param {Object} params the event parameters\n * @param {boolean} [params.bubbles=false]\n * @param {boolean} [params.cancelable=false]\n * @param {*} [params.detail]\n */\nfunction dispatch(element, name, params) {\n    element.dispatchEvent(new Custom(name, params || {}));\n}\n\n/**\n * Forwarding events\n *\n * @example\n * const { forwardingEvents } = require('event');\n * forwardingEvents('custom-event', fromNode, toNode, false);\n *\n * @param {string} name event name\n * @param {HTMLElement} fromElement\n * @param {HTMLElement} toElement\n * @param {boolean} [capture=false]\n * @returns {function} callback\n */\nfunction forwardingEvents(name, fromElement, toElement, capture = false) {\n    const callback = function (event) {\n        dispatch(toElement, name, {\n            bubbles: event.bubbles,\n            cancelable: event.cancelable,\n            detail: event.detail\n        });\n    };\n\n    callback.cancel = function () {\n        fromElement.removeEventListener(name, callback, capture);\n    };\n\n    fromElement.addEventListener(name, callback, capture);\n\n    return callback;\n}\n\nexports.Custom = Custom;\nexports.dispatch = dispatch;\nexports.forwardingEvents = forwardingEvents;\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/event.js\n **/","const context = require('../context');\n\n/**\n * @constant {Document}\n * @private\n */\nconst doc = context.document;\n\n/**\n * @constant {Object}\n * @private\n */\nconst protoEvent = context.Event.prototype;\n\nlet issetCustomEvent = false;\n\ntry {\n    issetCustomEvent = Boolean(doc.createEvent('CustomEvent'));\n} catch (e) {\n    // do nothing\n}\n\n/**\n * The original function \"stopImmediatePropagation\"\n * @constant {function}\n * @private\n */\nconst stopImmediatePropagation = protoEvent.stopImmediatePropagation;\n\n/**\n * Override function to set properties \"immediatePropagationStopped\"\n */\nprotoEvent.stopImmediatePropagation = function () {\n    this.immediatePropagationStopped = true;\n\n    if (stopImmediatePropagation) {\n        stopImmediatePropagation.call(this);\n\n    } else {\n        this.stopPropagation();\n    }\n};\n\nlet CustomEventCommon = (function () {\n    if (issetCustomEvent) {\n        return function (eventName, params) {\n            params = params || {};\n\n            let bubbles = Boolean(params.bubbles);\n            let cancelable = Boolean(params.cancelable);\n            let evt = doc.createEvent('CustomEvent');\n\n            evt.initCustomEvent(eventName, bubbles, cancelable, params.detail);\n\n            return evt;\n        };\n    }\n\n    return function (eventName, params) {\n        params = params || {};\n\n        let bubbles = Boolean(params.bubbles);\n        let cancelable = Boolean(params.cancelable);\n        let evt = doc.createEvent('Event');\n\n        evt.initEvent(eventName, bubbles, cancelable);\n        evt.detail = params.detail;\n\n        return evt;\n    };\n}());\n\nCustomEventCommon.prototype = protoEvent;\n\nmodule.exports = CustomEventCommon;\n\n\n\n/** WEBPACK FOOTER **\n ** ./polyfills/CustomEventCommon.js\n **/","const select = require('./select');\nconst bubbleset = require('./bubbleset');\nconst { CLS } = require('./constant');\n\nlet currentDragSet = null;\n\nexports.init = function (nodeSet) {\n    nodeSet.addEventListener('drop', onDrop);\n    nodeSet.addEventListener('dragover', onDragover);\n    nodeSet.addEventListener('dragenter', onDragenter);\n    nodeSet.addEventListener('dragleave', onDragleave);\n    nodeSet.addEventListener('dragstart', onDragstart);\n    nodeSet.addEventListener('dragend', onDragend);\n};\n\nexports.destroy = function (nodeSet) {\n    nodeSet.removeEventListener('drop', onDrop);\n    nodeSet.removeEventListener('dragover', onDragover);\n    nodeSet.removeEventListener('dragenter', onDragenter);\n    nodeSet.removeEventListener('dragleave', onDragleave);\n    nodeSet.removeEventListener('dragstart', onDragstart);\n    nodeSet.removeEventListener('dragend', onDragend);\n};\n\nfunction onDragstart(event) {\n    event.stopPropagation();\n\n    const nodeSet = bubbleset.closestNodeSet(event.target);\n    const nodeBubble = bubbleset.closestNodeBubble(event.target);\n\n    if (!nodeSet || !nodeBubble) {\n        event.preventDefault();\n        return;\n    }\n\n    currentDragSet = nodeSet;\n    nodeSet.classList.add(CLS.DRAGSTART);\n    select.add(nodeBubble);\n\n    event.dataTransfer.effectAllowed = 'move';\n    event.dataTransfer.setData('text/plain', '');\n}\n\nfunction onDrop(event) {\n    event.stopPropagation();\n    event.preventDefault();\n\n    if (!currentDragSet) {\n        return;\n    }\n\n    const nodeSet = bubbleset.closestNodeSet(event.target);\n\n    if (!nodeSet || nodeSet === currentDragSet) {\n        return;\n    }\n\n    const list = select.get(currentDragSet);\n\n    if (!list.length) {\n        return;\n    }\n\n    list.forEach(item => nodeSet.appendChild(item));\n    nodeSet.focus();\n}\n\nfunction onDragover(event) {\n    event.stopPropagation();\n    event.preventDefault();\n\n    if (!currentDragSet) {\n        return;\n    }\n\n    event.dataTransfer.dropEffect = 'move';\n}\n\nfunction onDragenter(event) {\n    event.stopPropagation();\n    event.preventDefault();\n\n    if (!currentDragSet) {\n        return;\n    }\n\n    const nodeSet = bubbleset.closestNodeSet(event.target);\n\n    if (!nodeSet || nodeSet === currentDragSet) {\n        return;\n    }\n\n    nodeSet.classList.add(CLS.DROPZONE);\n}\n\nfunction onDragleave(event) {\n    event.stopPropagation();\n    event.preventDefault();\n\n    if (!currentDragSet) {\n        return;\n    }\n\n    const nodeSet = bubbleset.closestNodeSet(event.target);\n\n    if (!nodeSet || nodeSet === currentDragSet) {\n        return;\n    }\n\n    nodeSet.classList.remove(CLS.DROPZONE);\n}\n\nfunction onDragend(event) {\n    event.stopPropagation();\n    event.preventDefault();\n\n    if (!currentDragSet) {\n        return;\n    }\n\n    currentDragSet.classList.remove(CLS.DRAGSTART);\n\n    const nodeSet = bubbleset.closestNodeSet(event.target);\n\n    if (nodeSet && nodeSet !== currentDragSet) {\n        nodeSet.classList.remove(CLS.DROPZONE);\n    }\n\n    currentDragSet = null;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/drag.js\n **/","exports.KEY = {\n    a: 65,\n    Backspace: 8,\n    Bottom: 40,\n    Comma: 44, // ,\n    Enter: 13, // Enter\n    Left: 37,\n    Right: 39,\n    Semicolon: 59, // ;\n    Tab: 9,\n    Top: 38,\n};\n\nexports.CLS = {\n    DRAGSTART: 'drag',\n    DROPZONE: 'dropzone',\n};\n\nexports.EV = {\n    BUBBLE_INPUT: 'bubble-input',\n    CHANGE: 'change',\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/constant.js\n **/","const bubbleset = require('./bubbleset');\nconst bubble = require('./bubble');\nconst cursor = require('./cursor');\nconst select = require('./select');\nconst { KEY } = require('./constant');\nconst context = require('../context');\nconst text = require('./text');\n\nconst slice = Array.prototype.slice;\n\nexports.init = function (nodeSet) {\n    nodeSet.addEventListener('keyup', keyup);\n    nodeSet.addEventListener('keydown', keydown);\n    nodeSet.addEventListener('keypress', keypress);\n    nodeSet.addEventListener('paste', paste);\n};\n\nexports.destroy = function (nodeSet) {\n    nodeSet.removeEventListener('keyup', keyup);\n    nodeSet.removeEventListener('keydown', keydown);\n    nodeSet.removeEventListener('keypress', keypress);\n    nodeSet.removeEventListener('paste', paste);\n};\n\nfunction keyup(event) {\n    event.currentTarget.fireInput();\n}\n\nfunction keypress(event) {\n    const code = event.charCode || event.keyCode;\n    const nodeSet = event.currentTarget;\n\n    /* eslint no-case-declarations: 0 */\n    switch (code) {\n    case KEY.Enter:\n    case KEY.Comma:\n    case KEY.Semicolon:\n        event.preventDefault();\n\n        if (nodeSet.hasAttribute('disable-controls')) {\n            return;\n        }\n\n        bubble.bubbling(nodeSet);\n        cursor.restore(nodeSet);\n        break;\n    }\n}\n\nfunction keydown(event) {\n    const code = event.charCode || event.keyCode;\n    const metaKey = event.metaKey;\n    const nodeSet = event.currentTarget;\n    const enable = !nodeSet.hasAttribute('disable-controls');\n\n    switch (code) {\n    case KEY.Backspace:\n        event.preventDefault();\n        backSpace(event);\n        break;\n\n    case KEY.Left:\n        event.preventDefault();\n        arrowLeft(event);\n        break;\n\n    // сдвигаем курсор в начало списка\n    case KEY.Top:\n        event.preventDefault();\n        if (enable) {\n            const headBubble = bubbleset.headBubble(nodeSet);\n            headBubble && select.uniq(headBubble);\n        }\n        break;\n\n    case KEY.Right:\n        event.preventDefault();\n        arrowRight(event);\n        break;\n\n    // сдвигаем курсор в конец списка\n    case KEY.Tab:\n    case KEY.Bottom:\n        event.preventDefault();\n        if (enable && select.has(nodeSet)) {\n            cursor.restore(nodeSet);\n        }\n        break;\n\n    case KEY.a:\n        if (metaKey) {\n            event.preventDefault();\n\n            if (!text.selectAll(null, event.currentTarget)) {\n                select.all(nodeSet);\n            }\n        }\n        break;\n    }\n}\n\nfunction arrowLeft(event) {\n    const selection = context.getSelection();\n\n    if (text.arrowLeft(selection, event.shiftKey)) {\n        return;\n    }\n\n    if (selection.anchorNode && selection.anchorNode.nodeType === Node.TEXT_NODE) {\n        const nodeBubble = bubbleset.prevBubble(selection.anchorNode);\n        nodeBubble && select.uniq(nodeBubble);\n        return;\n    }\n\n    const nodeSet = event.currentTarget;\n    const list = select.get(nodeSet);\n    const begin = do {\n        if (list.length > 1 && list[ 0 ] === nodeSet.startRangeSelect) {\n            list[ list.length - 1 ];\n\n        } else {\n            list[ 0 ];\n        }\n    };\n\n    const node = bubbleset.prevBubble(begin);\n\n    if (node) {\n        if (event.shiftKey) {\n            select.range(node);\n\n        } else {\n            select.uniq(node);\n        }\n    }\n}\n\nfunction arrowRight(event) {\n    const selection = context.getSelection();\n\n    if (text.arrowRight(selection, event.shiftKey)) {\n        return;\n    }\n\n    if (selection.focusNode && selection.focusNode.nodeType === Node.TEXT_NODE) {\n        const nodeBubble = bubbleset.nextBubble(selection.focusNode);\n        nodeBubble && select.uniq(nodeBubble);\n        return;\n    }\n\n    const nodeSet = event.currentTarget;\n    const list = select.get(nodeSet);\n    const begin = do {\n        if (list.length > 1 && list[ list.length - 1 ] === nodeSet.startRangeSelect) {\n            list[ 0 ];\n\n        } else {\n            list[ list.length - 1 ];\n        }\n    };\n\n    const node = bubbleset.nextBubble(begin);\n\n    if (node) {\n        if (event.shiftKey) {\n            select.range(node);\n\n        } else {\n            select.uniq(node);\n        }\n\n    } else if (begin && begin.nextSibling && begin.nextSibling.nodeType === Node.TEXT_NODE) {\n        select.clear(nodeSet);\n        selection.collapse(begin.nextSibling, 0);\n\n    } else {\n        cursor.restore(nodeSet);\n    }\n}\n\nfunction backSpace(event) {\n    const nodeSet = event.currentTarget;\n    nodeSet.normalize();\n\n    const selection = context.getSelection();\n    if (!selection) {\n        return;\n    }\n\n    if (selection.isCollapsed) {\n        if (text.arrowLeft(selection, true)) {\n            text.remove(selection);\n            nodeSet.fireInput();\n            return;\n        }\n\n    } else {\n        text.remove(selection);\n        nodeSet.fireInput();\n        return;\n    }\n\n    let node = bubbleset.findBubbleLeft(selection);\n    if (node) {\n        select.uniq(node);\n        return;\n    }\n\n    const list = select.get(nodeSet);\n\n    if (list.length) {\n        const prevBubble = list[ 0 ].previousSibling;\n        const nextBubble = list[ list.length - 1 ].nextSibling;\n        list.forEach(item => item.parentNode.removeChild(item));\n\n        if (bubble.isBubbleNode(prevBubble)) {\n            select.uniq(prevBubble);\n\n        } else if (bubble.isBubbleNode(nextBubble)) {\n            select.uniq(nextBubble);\n\n        } else {\n            nodeSet.focus();\n            cursor.restore(nodeSet);\n            nodeSet.fireChange();\n        }\n    }\n}\n\nfunction paste(event) {\n    event.preventDefault();\n\n    const clipboardData = event.clipboardData;\n    if (!clipboardData) {\n        return;\n    }\n\n    const contentType = 'text/plain';\n    let data = clipboardData.getData && clipboardData.getData(contentType);\n\n    if (!text.replaceString(data) && clipboardData.items) {\n        slice.call(clipboardData.items)\n            .filter(item => item.kind === 'string' && item.type === contentType)\n            .some(function (item) {\n                item.getAsString(text.replaceString);\n                return true;\n            });\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./core/editor.js\n **/"],"sourceRoot":""}